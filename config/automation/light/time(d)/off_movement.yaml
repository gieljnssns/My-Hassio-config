alias: "Uit na aanwezigheid"
id: 862d6268-71cb-472b-b6fd-dcebe484af14
mode: parallel
trigger:
  - platform: state
    entity_id: binary_sensor.aanwezigheid_waskot
    to: "off"
    for:
      minutes: 2
  - platform: state
    entity_id: binary_sensor.aanwezigheid_wc
    to: "off"
    for:
      minutes: 2
  - platform: state
    entity_id: binary_sensor.aanwezigheid_zithoek
    to: "off"
  - platform: state
    entity_id: binary_sensor.aanwezigheid_danszaal
    to: "off"
  - platform: state
    entity_id: binary_sensor.beweging_keuken
    to: "off"
  - platform: state
    entity_id: binary_sensor.aanwezigheid_slaapkamer
    to: "off"
  - platform: state
    entity_id: binary_sensor.aanwezigheid_noor
    to: "off"
  - platform: state
    entity_id: binary_sensor.aanwezigheid_fien
    to: "off"
  - platform: state
    entity_id: binary_sensor.beweging_garage
    to: "off"
    for:
      minutes: 10
condition:
  condition: and
  conditions:
    - condition: template
      value_template: >
        {%  if trigger.entity_id == 'binary_sensor.aanwezigheid_danszaal'  %}
            {{  states('binary_sensor.imac_5k_active_2') == 'off'  }}
        {%  else  %}
            True
        {%  endif  %}

action:
  - service: light.turn_off
    data_template:
      entity_id: >
        {% if trigger.entity_id == 'binary_sensor.aanwezigheid_badkamer' %}
          light.badkamer_pombak
        {% elif trigger.entity_id == 'binary_sensor.beweging_keuken' %}
          light.keuken_spots, light.keuken_inkom, light.keuken_luster
        {% elif trigger.entity_id == 'binary_sensor.aanwezigheid_zithoek' %}
          light.zithoek_luster
        {% elif trigger.entity_id == 'binary_sensor.aanwezigheid_danszaal' %}
          light.danszaal_luster, light.danszaal_spots
        {% elif trigger.entity_id == 'binary_sensor.aanwezigheid_noor' %}
          light.noor
        {% elif trigger.entity_id == 'binary_sensor.aanwezigheid_fien' %}
          light.fien
        {% elif trigger.entity_id == 'binary_sensor.aanwezigheid_waskot' %}
          light.waskot
        {% elif trigger.entity_id == 'binary_sensor.aanwezigheid_wc' %}
          light.wc
        {% elif trigger.entity_id == 'binary_sensor.beweging_garage' %}
          light.garage, light.garage_werkbank, light.vogelpik, light.garage_sjotterbak, light.garage_sfeerverlichting
        {% else %}
          light.slaapkamer_hoog, light.spot_slaapkamer
        {% endif %}
