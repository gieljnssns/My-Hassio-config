function e(e,t,o,i){var a,r=arguments.length,n=r<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(e,t,o,i);else for(var l=e.length-1;l>=0;l--)(a=e[l])&&(n=(r<3?a(n):r>3?a(t,o,n):a(t,o))||n);return r>3&&n&&Object.defineProperty(t,o,n),n}const t=window,o=t.ShadowRoot&&(void 0===t.ShadyCSS||t.ShadyCSS.nativeShadow)&&"adoptedStyleSheets"in Document.prototype&&"replace"in CSSStyleSheet.prototype,i=Symbol(),a=new WeakMap;class r{constructor(e,t,o){if(this._$cssResult$=!0,o!==i)throw Error("CSSResult is not constructable. Use `unsafeCSS` or `css` instead.");this.cssText=e,this.t=t}get styleSheet(){let e=this.o;const t=this.t;if(o&&void 0===e){const o=void 0!==t&&1===t.length;o&&(e=a.get(t)),void 0===e&&((this.o=e=new CSSStyleSheet).replaceSync(this.cssText),o&&a.set(t,e))}return e}toString(){return this.cssText}}const n=(e,...t)=>{const o=1===e.length?e[0]:t.reduce(((t,o,i)=>t+(e=>{if(!0===e._$cssResult$)return e.cssText;if("number"==typeof e)return e;throw Error("Value passed to 'css' function must be a 'css' function result: "+e+". Use 'unsafeCSS' to pass non-literal values, but take care to ensure page security.")})(o)+e[i+1]),e[0]);return new r(o,e,i)},l=o?e=>e:e=>e instanceof CSSStyleSheet?(e=>{let t="";for(const o of e.cssRules)t+=o.cssText;return(e=>new r("string"==typeof e?e:e+"",void 0,i))(t)})(e):e;var s;const d=window,c=d.trustedTypes,u=c?c.emptyScript:"",h=d.reactiveElementPolyfillSupport,v={toAttribute(e,t){switch(t){case Boolean:e=e?u:null;break;case Object:case Array:e=null==e?e:JSON.stringify(e)}return e},fromAttribute(e,t){let o=e;switch(t){case Boolean:o=null!==e;break;case Number:o=null===e?null:Number(e);break;case Object:case Array:try{o=JSON.parse(e)}catch(e){o=null}}return o}},_=(e,t)=>t!==e&&(t==t||e==e),p={attribute:!0,type:String,converter:v,reflect:!1,hasChanged:_};class m extends HTMLElement{constructor(){super(),this._$Ei=new Map,this.isUpdatePending=!1,this.hasUpdated=!1,this._$El=null,this.u()}static addInitializer(e){var t;this.finalize(),(null!==(t=this.h)&&void 0!==t?t:this.h=[]).push(e)}static get observedAttributes(){this.finalize();const e=[];return this.elementProperties.forEach(((t,o)=>{const i=this._$Ep(o,t);void 0!==i&&(this._$Ev.set(i,o),e.push(i))})),e}static createProperty(e,t=p){if(t.state&&(t.attribute=!1),this.finalize(),this.elementProperties.set(e,t),!t.noAccessor&&!this.prototype.hasOwnProperty(e)){const o="symbol"==typeof e?Symbol():"__"+e,i=this.getPropertyDescriptor(e,o,t);void 0!==i&&Object.defineProperty(this.prototype,e,i)}}static getPropertyDescriptor(e,t,o){return{get(){return this[t]},set(i){const a=this[e];this[t]=i,this.requestUpdate(e,a,o)},configurable:!0,enumerable:!0}}static getPropertyOptions(e){return this.elementProperties.get(e)||p}static finalize(){if(this.hasOwnProperty("finalized"))return!1;this.finalized=!0;const e=Object.getPrototypeOf(this);if(e.finalize(),void 0!==e.h&&(this.h=[...e.h]),this.elementProperties=new Map(e.elementProperties),this._$Ev=new Map,this.hasOwnProperty("properties")){const e=this.properties,t=[...Object.getOwnPropertyNames(e),...Object.getOwnPropertySymbols(e)];for(const o of t)this.createProperty(o,e[o])}return this.elementStyles=this.finalizeStyles(this.styles),!0}static finalizeStyles(e){const t=[];if(Array.isArray(e)){const o=new Set(e.flat(1/0).reverse());for(const e of o)t.unshift(l(e))}else void 0!==e&&t.push(l(e));return t}static _$Ep(e,t){const o=t.attribute;return!1===o?void 0:"string"==typeof o?o:"string"==typeof e?e.toLowerCase():void 0}u(){var e;this._$E_=new Promise((e=>this.enableUpdating=e)),this._$AL=new Map,this._$Eg(),this.requestUpdate(),null===(e=this.constructor.h)||void 0===e||e.forEach((e=>e(this)))}addController(e){var t,o;(null!==(t=this._$ES)&&void 0!==t?t:this._$ES=[]).push(e),void 0!==this.renderRoot&&this.isConnected&&(null===(o=e.hostConnected)||void 0===o||o.call(e))}removeController(e){var t;null===(t=this._$ES)||void 0===t||t.splice(this._$ES.indexOf(e)>>>0,1)}_$Eg(){this.constructor.elementProperties.forEach(((e,t)=>{this.hasOwnProperty(t)&&(this._$Ei.set(t,this[t]),delete this[t])}))}createRenderRoot(){var e;const i=null!==(e=this.shadowRoot)&&void 0!==e?e:this.attachShadow(this.constructor.shadowRootOptions);return((e,i)=>{o?e.adoptedStyleSheets=i.map((e=>e instanceof CSSStyleSheet?e:e.styleSheet)):i.forEach((o=>{const i=document.createElement("style"),a=t.litNonce;void 0!==a&&i.setAttribute("nonce",a),i.textContent=o.cssText,e.appendChild(i)}))})(i,this.constructor.elementStyles),i}connectedCallback(){var e;void 0===this.renderRoot&&(this.renderRoot=this.createRenderRoot()),this.enableUpdating(!0),null===(e=this._$ES)||void 0===e||e.forEach((e=>{var t;return null===(t=e.hostConnected)||void 0===t?void 0:t.call(e)}))}enableUpdating(e){}disconnectedCallback(){var e;null===(e=this._$ES)||void 0===e||e.forEach((e=>{var t;return null===(t=e.hostDisconnected)||void 0===t?void 0:t.call(e)}))}attributeChangedCallback(e,t,o){this._$AK(e,o)}_$EO(e,t,o=p){var i;const a=this.constructor._$Ep(e,o);if(void 0!==a&&!0===o.reflect){const r=(void 0!==(null===(i=o.converter)||void 0===i?void 0:i.toAttribute)?o.converter:v).toAttribute(t,o.type);this._$El=e,null==r?this.removeAttribute(a):this.setAttribute(a,r),this._$El=null}}_$AK(e,t){var o;const i=this.constructor,a=i._$Ev.get(e);if(void 0!==a&&this._$El!==a){const e=i.getPropertyOptions(a),r="function"==typeof e.converter?{fromAttribute:e.converter}:void 0!==(null===(o=e.converter)||void 0===o?void 0:o.fromAttribute)?e.converter:v;this._$El=a,this[a]=r.fromAttribute(t,e.type),this._$El=null}}requestUpdate(e,t,o){let i=!0;void 0!==e&&(((o=o||this.constructor.getPropertyOptions(e)).hasChanged||_)(this[e],t)?(this._$AL.has(e)||this._$AL.set(e,t),!0===o.reflect&&this._$El!==e&&(void 0===this._$EC&&(this._$EC=new Map),this._$EC.set(e,o))):i=!1),!this.isUpdatePending&&i&&(this._$E_=this._$Ej())}async _$Ej(){this.isUpdatePending=!0;try{await this._$E_}catch(e){Promise.reject(e)}const e=this.scheduleUpdate();return null!=e&&await e,!this.isUpdatePending}scheduleUpdate(){return this.performUpdate()}performUpdate(){var e;if(!this.isUpdatePending)return;this.hasUpdated,this._$Ei&&(this._$Ei.forEach(((e,t)=>this[t]=e)),this._$Ei=void 0);let t=!1;const o=this._$AL;try{t=this.shouldUpdate(o),t?(this.willUpdate(o),null===(e=this._$ES)||void 0===e||e.forEach((e=>{var t;return null===(t=e.hostUpdate)||void 0===t?void 0:t.call(e)})),this.update(o)):this._$Ek()}catch(e){throw t=!1,this._$Ek(),e}t&&this._$AE(o)}willUpdate(e){}_$AE(e){var t;null===(t=this._$ES)||void 0===t||t.forEach((e=>{var t;return null===(t=e.hostUpdated)||void 0===t?void 0:t.call(e)})),this.hasUpdated||(this.hasUpdated=!0,this.firstUpdated(e)),this.updated(e)}_$Ek(){this._$AL=new Map,this.isUpdatePending=!1}get updateComplete(){return this.getUpdateComplete()}getUpdateComplete(){return this._$E_}shouldUpdate(e){return!0}update(e){void 0!==this._$EC&&(this._$EC.forEach(((e,t)=>this._$EO(t,this[t],e))),this._$EC=void 0),this._$Ek()}updated(e){}firstUpdated(e){}}var y;m.finalized=!0,m.elementProperties=new Map,m.elementStyles=[],m.shadowRootOptions={mode:"open"},null==h||h({ReactiveElement:m}),(null!==(s=d.reactiveElementVersions)&&void 0!==s?s:d.reactiveElementVersions=[]).push("1.6.1");const g=window,f=g.trustedTypes,b=f?f.createPolicy("lit-html",{createHTML:e=>e}):void 0,w="$lit$",x=`lit$${(Math.random()+"").slice(9)}$`,k="?"+x,$=`<${k}>`,E=document,S=()=>E.createComment(""),C=e=>null===e||"object"!=typeof e&&"function"!=typeof e,A=Array.isArray,z="[ \t\n\f\r]",M=/<(?:(!--|\/[^a-zA-Z])|(\/?[a-zA-Z][^>\s]*)|(\/?$))/g,D=/-->/g,P=/>/g,j=RegExp(`>|${z}(?:([^\\s"'>=/]+)(${z}*=${z}*(?:[^ \t\n\f\r"'\`<>=]|("|')|))|$)`,"g"),O=/'/g,T=/"/g,N=/^(?:script|style|textarea|title)$/i,U=e=>(t,...o)=>({_$litType$:e,strings:t,values:o}),B=U(1),G=U(2),I=Symbol.for("lit-noChange"),H=Symbol.for("lit-nothing"),F=new WeakMap,R=E.createTreeWalker(E,129,null,!1),L=(e,t)=>{const o=e.length-1,i=[];let a,r=2===t?"<svg>":"",n=M;for(let t=0;t<o;t++){const o=e[t];let l,s,d=-1,c=0;for(;c<o.length&&(n.lastIndex=c,s=n.exec(o),null!==s);)c=n.lastIndex,n===M?"!--"===s[1]?n=D:void 0!==s[1]?n=P:void 0!==s[2]?(N.test(s[2])&&(a=RegExp("</"+s[2],"g")),n=j):void 0!==s[3]&&(n=j):n===j?">"===s[0]?(n=null!=a?a:M,d=-1):void 0===s[1]?d=-2:(d=n.lastIndex-s[2].length,l=s[1],n=void 0===s[3]?j:'"'===s[3]?T:O):n===T||n===O?n=j:n===D||n===P?n=M:(n=j,a=void 0);const u=n===j&&e[t+1].startsWith("/>")?" ":"";r+=n===M?o+$:d>=0?(i.push(l),o.slice(0,d)+w+o.slice(d)+x+u):o+x+(-2===d?(i.push(void 0),t):u)}const l=r+(e[o]||"<?>")+(2===t?"</svg>":"");if(!Array.isArray(e)||!e.hasOwnProperty("raw"))throw Error("invalid template strings array");return[void 0!==b?b.createHTML(l):l,i]};class W{constructor({strings:e,_$litType$:t},o){let i;this.parts=[];let a=0,r=0;const n=e.length-1,l=this.parts,[s,d]=L(e,t);if(this.el=W.createElement(s,o),R.currentNode=this.el.content,2===t){const e=this.el.content,t=e.firstChild;t.remove(),e.append(...t.childNodes)}for(;null!==(i=R.nextNode())&&l.length<n;){if(1===i.nodeType){if(i.hasAttributes()){const e=[];for(const t of i.getAttributeNames())if(t.endsWith(w)||t.startsWith(x)){const o=d[r++];if(e.push(t),void 0!==o){const e=i.getAttribute(o.toLowerCase()+w).split(x),t=/([.?@])?(.*)/.exec(o);l.push({type:1,index:a,name:t[2],strings:e,ctor:"."===t[1]?q:"?"===t[1]?Q:"@"===t[1]?X:Y})}else l.push({type:6,index:a})}for(const t of e)i.removeAttribute(t)}if(N.test(i.tagName)){const e=i.textContent.split(x),t=e.length-1;if(t>0){i.textContent=f?f.emptyScript:"";for(let o=0;o<t;o++)i.append(e[o],S()),R.nextNode(),l.push({type:2,index:++a});i.append(e[t],S())}}}else if(8===i.nodeType)if(i.data===k)l.push({type:2,index:a});else{let e=-1;for(;-1!==(e=i.data.indexOf(x,e+1));)l.push({type:7,index:a}),e+=x.length-1}a++}}static createElement(e,t){const o=E.createElement("template");return o.innerHTML=e,o}}function V(e,t,o=e,i){var a,r,n,l;if(t===I)return t;let s=void 0!==i?null===(a=o._$Co)||void 0===a?void 0:a[i]:o._$Cl;const d=C(t)?void 0:t._$litDirective$;return(null==s?void 0:s.constructor)!==d&&(null===(r=null==s?void 0:s._$AO)||void 0===r||r.call(s,!1),void 0===d?s=void 0:(s=new d(e),s._$AT(e,o,i)),void 0!==i?(null!==(n=(l=o)._$Co)&&void 0!==n?n:l._$Co=[])[i]=s:o._$Cl=s),void 0!==s&&(t=V(e,s._$AS(e,t.values),s,i)),t}class K{constructor(e,t){this._$AV=[],this._$AN=void 0,this._$AD=e,this._$AM=t}get parentNode(){return this._$AM.parentNode}get _$AU(){return this._$AM._$AU}u(e){var t;const{el:{content:o},parts:i}=this._$AD,a=(null!==(t=null==e?void 0:e.creationScope)&&void 0!==t?t:E).importNode(o,!0);R.currentNode=a;let r=R.nextNode(),n=0,l=0,s=i[0];for(;void 0!==s;){if(n===s.index){let t;2===s.type?t=new Z(r,r.nextSibling,this,e):1===s.type?t=new s.ctor(r,s.name,s.strings,this,e):6===s.type&&(t=new ee(r,this,e)),this._$AV.push(t),s=i[++l]}n!==(null==s?void 0:s.index)&&(r=R.nextNode(),n++)}return a}v(e){let t=0;for(const o of this._$AV)void 0!==o&&(void 0!==o.strings?(o._$AI(e,o,t),t+=o.strings.length-2):o._$AI(e[t])),t++}}class Z{constructor(e,t,o,i){var a;this.type=2,this._$AH=H,this._$AN=void 0,this._$AA=e,this._$AB=t,this._$AM=o,this.options=i,this._$Cp=null===(a=null==i?void 0:i.isConnected)||void 0===a||a}get _$AU(){var e,t;return null!==(t=null===(e=this._$AM)||void 0===e?void 0:e._$AU)&&void 0!==t?t:this._$Cp}get parentNode(){let e=this._$AA.parentNode;const t=this._$AM;return void 0!==t&&11===(null==e?void 0:e.nodeType)&&(e=t.parentNode),e}get startNode(){return this._$AA}get endNode(){return this._$AB}_$AI(e,t=this){e=V(this,e,t),C(e)?e===H||null==e||""===e?(this._$AH!==H&&this._$AR(),this._$AH=H):e!==this._$AH&&e!==I&&this._(e):void 0!==e._$litType$?this.g(e):void 0!==e.nodeType?this.$(e):(e=>A(e)||"function"==typeof(null==e?void 0:e[Symbol.iterator]))(e)?this.T(e):this._(e)}k(e){return this._$AA.parentNode.insertBefore(e,this._$AB)}$(e){this._$AH!==e&&(this._$AR(),this._$AH=this.k(e))}_(e){this._$AH!==H&&C(this._$AH)?this._$AA.nextSibling.data=e:this.$(E.createTextNode(e)),this._$AH=e}g(e){var t;const{values:o,_$litType$:i}=e,a="number"==typeof i?this._$AC(e):(void 0===i.el&&(i.el=W.createElement(i.h,this.options)),i);if((null===(t=this._$AH)||void 0===t?void 0:t._$AD)===a)this._$AH.v(o);else{const e=new K(a,this),t=e.u(this.options);e.v(o),this.$(t),this._$AH=e}}_$AC(e){let t=F.get(e.strings);return void 0===t&&F.set(e.strings,t=new W(e)),t}T(e){A(this._$AH)||(this._$AH=[],this._$AR());const t=this._$AH;let o,i=0;for(const a of e)i===t.length?t.push(o=new Z(this.k(S()),this.k(S()),this,this.options)):o=t[i],o._$AI(a),i++;i<t.length&&(this._$AR(o&&o._$AB.nextSibling,i),t.length=i)}_$AR(e=this._$AA.nextSibling,t){var o;for(null===(o=this._$AP)||void 0===o||o.call(this,!1,!0,t);e&&e!==this._$AB;){const t=e.nextSibling;e.remove(),e=t}}setConnected(e){var t;void 0===this._$AM&&(this._$Cp=e,null===(t=this._$AP)||void 0===t||t.call(this,e))}}class Y{constructor(e,t,o,i,a){this.type=1,this._$AH=H,this._$AN=void 0,this.element=e,this.name=t,this._$AM=i,this.options=a,o.length>2||""!==o[0]||""!==o[1]?(this._$AH=Array(o.length-1).fill(new String),this.strings=o):this._$AH=H}get tagName(){return this.element.tagName}get _$AU(){return this._$AM._$AU}_$AI(e,t=this,o,i){const a=this.strings;let r=!1;if(void 0===a)e=V(this,e,t,0),r=!C(e)||e!==this._$AH&&e!==I,r&&(this._$AH=e);else{const i=e;let n,l;for(e=a[0],n=0;n<a.length-1;n++)l=V(this,i[o+n],t,n),l===I&&(l=this._$AH[n]),r||(r=!C(l)||l!==this._$AH[n]),l===H?e=H:e!==H&&(e+=(null!=l?l:"")+a[n+1]),this._$AH[n]=l}r&&!i&&this.j(e)}j(e){e===H?this.element.removeAttribute(this.name):this.element.setAttribute(this.name,null!=e?e:"")}}class q extends Y{constructor(){super(...arguments),this.type=3}j(e){this.element[this.name]=e===H?void 0:e}}const J=f?f.emptyScript:"";class Q extends Y{constructor(){super(...arguments),this.type=4}j(e){e&&e!==H?this.element.setAttribute(this.name,J):this.element.removeAttribute(this.name)}}class X extends Y{constructor(e,t,o,i,a){super(e,t,o,i,a),this.type=5}_$AI(e,t=this){var o;if((e=null!==(o=V(this,e,t,0))&&void 0!==o?o:H)===I)return;const i=this._$AH,a=e===H&&i!==H||e.capture!==i.capture||e.once!==i.once||e.passive!==i.passive,r=e!==H&&(i===H||a);a&&this.element.removeEventListener(this.name,this,i),r&&this.element.addEventListener(this.name,this,e),this._$AH=e}handleEvent(e){var t,o;"function"==typeof this._$AH?this._$AH.call(null!==(o=null===(t=this.options)||void 0===t?void 0:t.host)&&void 0!==o?o:this.element,e):this._$AH.handleEvent(e)}}class ee{constructor(e,t,o){this.element=e,this.type=6,this._$AN=void 0,this._$AM=t,this.options=o}get _$AU(){return this._$AM._$AU}_$AI(e){V(this,e)}}const te=g.litHtmlPolyfillSupport;null==te||te(W,Z),(null!==(y=g.litHtmlVersions)&&void 0!==y?y:g.litHtmlVersions=[]).push("2.7.3");var oe,ie;class ae extends m{constructor(){super(...arguments),this.renderOptions={host:this},this._$Do=void 0}createRenderRoot(){var e,t;const o=super.createRenderRoot();return null!==(e=(t=this.renderOptions).renderBefore)&&void 0!==e||(t.renderBefore=o.firstChild),o}update(e){const t=this.render();this.hasUpdated||(this.renderOptions.isConnected=this.isConnected),super.update(e),this._$Do=((e,t,o)=>{var i,a;const r=null!==(i=null==o?void 0:o.renderBefore)&&void 0!==i?i:t;let n=r._$litPart$;if(void 0===n){const e=null!==(a=null==o?void 0:o.renderBefore)&&void 0!==a?a:null;r._$litPart$=n=new Z(t.insertBefore(S(),e),e,void 0,null!=o?o:{})}return n._$AI(e),n})(t,this.renderRoot,this.renderOptions)}connectedCallback(){var e;super.connectedCallback(),null===(e=this._$Do)||void 0===e||e.setConnected(!0)}disconnectedCallback(){var e;super.disconnectedCallback(),null===(e=this._$Do)||void 0===e||e.setConnected(!1)}render(){return I}}ae.finalized=!0,ae._$litElement$=!0,null===(oe=globalThis.litElementHydrateSupport)||void 0===oe||oe.call(globalThis,{LitElement:ae});const re=globalThis.litElementPolyfillSupport;null==re||re({LitElement:ae}),(null!==(ie=globalThis.litElementVersions)&&void 0!==ie?ie:globalThis.litElementVersions=[]).push("3.3.2");const ne=e=>t=>"function"==typeof t?((e,t)=>(customElements.define(e,t),t))(e,t):((e,t)=>{const{kind:o,elements:i}=t;return{kind:o,elements:i,finisher(t){customElements.define(e,t)}}})(e,t),le=(e,t)=>"method"===t.kind&&t.descriptor&&!("value"in t.descriptor)?{...t,finisher(o){o.createProperty(t.key,e)}}:{kind:"field",key:Symbol(),placement:"own",descriptor:{},originalKey:t.key,initializer(){"function"==typeof t.initializer&&(this[t.key]=t.initializer.call(this))},finisher(o){o.createProperty(t.key,e)}};function se(e){return(t,o)=>void 0!==o?((e,t,o)=>{t.constructor.createProperty(o,e)})(e,t,o):le(e,t)}function de(e){return se({...e,state:!0})}var ce;null===(ce=window.HTMLSlotElement)||void 0===ce||ce.prototype.assignedElements;var ue={label:{car:"Car",motorbike:"Motorbike"}},he={combined:"Combined Entity (One entity with positive and negative values)",separated:"Separated Entities (One entity for consumption and one for production)",custom_colors:"Custom Colors",secondary_info:"Secondary Info",power_outage:"Power Outage",grid:"Grid",solar:"Solar",battery:"Battery",fossil_fuel_percentage:"Fossil Fuel",home:"Home",individual:"Individual",advanced:"Advanced Options",decimals:"Decimals",consumption:"Consumption",production:"Production",color_icon:"Color of Icon",color_circle:"Color of Circle",color_value:"Color of Value",color_state_of_charge_value:"Color",display_zero:"Display Zero",display_zero_tolerance:"Display Zero Tolerance",display_state:"Display State",display_zero_state:"Display Zero State",invert_state:"Invert State",template:"Template",unit_of_measurement:"Unit",unit_white_space:"Unit White Space",label_alert:"Label for Alert",icon_alert:"Icon for Alert",state_alert:"State of Alert",state_of_charge:"State of Charge",state_of_charge_unit_white_space:"White Space",state_of_charge_unit:"Unit",state_of_charge_decimals:"Decimals",state_of_charge_icon:"Icon",state_type:"Type of State",subtract_individual:"Subtract Individual",override_state:"Override State",calculate_flow_rate:"Calculate Flow Rate",inverted_animation:"Invert Animation",show_direction:"Show Direction",color:"Color",dashboard_link:"Dashboard Link",dashboard_link_label:"Dashboard Link Name",wh_decimals:"Watthours Decimals",kwh_decimals:"Kilowatthours Decimals",mwh_decimals:"Megawatthours Decimals",max_flow_rate:"Max Flow Rate",min_flow_rate:"Min Flow Rate",max_expected_energy:"Max Expected Energy",min_expected_energy:"Min Expected Energy",wh_kwh_threshold:"Watthours to Kilowatthours Threshold",kwh_mwh_threshold:"Kilowatthours to Megawatthours Threshold",display_zero_lines:"Display Zero Lines",clickable_entities:"Clickable Entities",use_new_flow_rate_model:"New Flow Rate Model",use_metadata:"Use Metadata",energy_date_selection:"Energy Date Selection",show:"Show"},ve={card:ue,editor:he},_e={label:{car:"Auto",motorbike:"Motorrad"}},pe={combined:"Kombinierte Entität (Eine Entität mit positiven und negativen Werten)",separated:"Getrennte Entitäten (Eine Entität für den Verbrauch und eine für die Produktion)",custom_colors:"Benutzerdefinierte Farben",secondary_info:"Sekundäre Information",power_outage:"Stromausfall",grid:"Netz",solar:"Solar",battery:"Batterie",fossil_fuel_percentage:"Fossile Brennstoffe",home:"Zuhause",individual:"Individuell",advanced:"Erweiterte Optionen",decimals:"Dezimalstellen",consumption:"Verbrauch",production:"Produktion",color_icon:"Farbe des Symbols",color_circle:"Farbe des Kreises",color_value:"Farbe des Wertes",color_state_of_charge_value:"Farbe",display_zero:"Null anzeigen",display_zero_tolerance:"Nulltoleranz",display_state:"Zustand anzeigen",display_zero_state:"Nullzustand anzeigen",invert_state:"Zustand umkehren",template:"Vorlage",unit_of_measurement:"Einheit",unit_white_space:"Weißraum für Einheit",label_alert:"Beschriftung für Alarm",icon_alert:"Symbol für Alarm",state_alert:"Alarmzustand",state_of_charge:"Ladezustand",state_of_charge_unit_white_space:"Leerzeichen",state_of_charge_unit:"Einheit",state_of_charge_decimals:"Dezimalstellen",state_of_charge_icon:"Symbol",state_type:"Typ des Zustands",subtract_individual:"Individuell abziehen",override_state:"Zustand überschreiben",calculate_flow_rate:"Flussrate berechnen",inverted_animation:"Animation umkehren",show_direction:"Richtung anzeigen",color:"Farbe",dashboard_link:"Dashboard-Link",dashboard_link_label:"Name des Dashboard-Links",wh_decimals:"Wattstunden-Dezimalstellen",kwh_decimals:"Kilowattstunden-Dezimalstellen",mwh_decimals:"Megawattstunden-Dezimalstellen",max_flow_rate:"Maximale Flussrate",min_flow_rate:"Minimale Flussrate",max_expected_energy:"Maximale erwartete Energie",min_expected_energy:"Minimale erwartete Energie",wh_kwh_threshold:"Wattstunden-zu-Kilowattstunden-Schwelle",kwh_mwh_threshold:"Kilowattstunden-zu-Megawattstunden-Schwelle",display_zero_lines:"Nulllinien anzeigen",clickable_entities:"Klickbare Entitäten",use_new_flow_rate_model:"Neues Fluss-Modell verwenden",use_metadata:"Metadaten verwenden",energy_date_selection:"Datumsauswahl",show:"Anzeigen"},me={card:_e,editor:pe},ye={label:{car:"Carro",motorbike:"Mota"}},ge={combined:"Entidade combinada (Uma entidade com valores positivos e negativos)",separated:"Entidades separadas (Uma entidade para consumo e outra para produção)",custom_colors:"Cores personalizadas",secondary_info:"Informação secundária",power_outage:"Interrupção de energia",grid:"Rede",solar:"Solar",battery:"Bateria",fossil_fuel_percentage:"Combustíveis Fósseis",home:"Casa",individual:"Individual",advanced:"Opções avançadas",decimals:"Casas decimais",consumption:"Consumo",production:"Produção",color_icon:"Cor do ícone",color_circle:"Cor do círculo",color_value:"Cor do valor",color_state_of_charge_value:"Cor",display_zero:"Mostrar zero",display_zero_tolerance:"Tolerância para mostrar zero",display_state:"Mostrar estado",display_zero_state:"Mostrar estado zero",invert_state:"Inverter estado",template:"Modelo",unit_of_measurement:"Unidade",unit_white_space:"Espaço entre unidades",label_alert:"Etiqueta para alerta",icon_alert:"Ícone para alerta",state_alert:"Estado do alerta",state_of_charge:"Estado de carga",state_of_charge_unit_white_space:"Espaço entre unidade e estado de carga",state_of_charge_unit:"Unidade",state_of_charge_decimals:"Casas decimais",state_of_charge_icon:"Ícone",state_type:"Tipo de estado",subtract_individual:"Subtrair individual",override_state:"Substituir estado",calculate_flow_rate:"Calcular taxa de fluxo",inverted_animation:"Animação invertida",show_direction:"Mostrar direção",color:"Cor",dashboard_link:"Link do painel de controle",dashboard_link_label:"Nome do link do painel de controle",wh_decimals:"Casas decimais de watt-hora",kwh_decimals:"Casas decimais de quilowatt-hora",mwh_decimals:"Casas decimais de megawatt-hora",max_flow_rate:"Taxa máxima de fluxo",min_flow_rate:"Taxa mínima de fluxo",max_expected_energy:"Energia máxima esperada",min_expected_energy:"Energia mínima esperada",wh_kwh_threshold:"Limiar de watt-hora para quilowatt-hora",kwh_mwh_threshold:"Limiar de quilowatt-hora para megawatt-hora",display_zero_lines:"Mostrar linhas de zero",clickable_entities:"Entidades clicáveis",use_new_flow_rate_model:"Usar novo modelo de taxa de fluxo",use_metadata:"Usar metadados",energy_date_selection:"Seleção de data de energia",show:"Mostrar"},fe={card:ye,editor:ge},be={label:{car:"Carro",motorbike:"Motocicleta"}},we={combined:"Entidade combinada (Uma entidade com valores positivos e negativos)",separated:"Entidades separadas (Uma entidade para consumo e outra para produção)",custom_colors:"Cores personalizadas",secondary_info:"Informação secundária",power_outage:"Interrupção de energia",grid:"Rede",solar:"Solar",battery:"Bateria",fossil_fuel_percentage:"Combustível fóssil",home:"Casa",individual:"Individual",advanced:"Opções avançadas",decimals:"Casas decimais",consumption:"Consumo",production:"Produção",color_icon:"Cor do ícone",color_circle:"Cor do círculo",color_value:"Cor do valor",color_state_of_charge_value:"Cor",display_zero:"Exibir zero",display_zero_tolerance:"Tolerância de exibição de zero",display_state:"Exibir estado",display_zero_state:"Exibir estado zero",invert_state:"Inverter estado",template:"Modelo",unit_of_measurement:"Unidade",unit_white_space:"Espaçamento da unidade",label_alert:"Rótulo para alerta",icon_alert:"Ícone para alerta",state_alert:"Estado do alerta",state_of_charge:"Estado de carga",state_of_charge_unit_white_space:"Espaçamento da unidade",state_of_charge_unit:"Unidade",state_of_charge_decimals:"Casas decimais",state_of_charge_icon:"Ícone",state_type:"Tipo de estado",subtract_individual:"Subtrair individual",override_state:"Sobrescrever estado",calculate_flow_rate:"Calcular taxa de fluxo",inverted_animation:"Animação invertida",show_direction:"Mostrar direção",color:"Cor",dashboard_link:"Link do painel",dashboard_link_label:"Nome do link do painel",wh_decimals:"Casas decimais de watt-hora",kwh_decimals:"Casas decimais de quilowatt-hora",mwh_decimals:"Casas decimais de megawatt-hora",max_flow_rate:"Taxa de fluxo máxima",min_flow_rate:"Taxa de fluxo mínima",max_expected_energy:"Energia máxima esperada",min_expected_energy:"Energia mínima esperada",wh_kwh_threshold:"Limiar de watt-hora para quilowatt-hora",kwh_mwh_threshold:"Limiar de quilowatt-hora para megawatt-hora",display_zero_lines:"Exibir linhas zero",clickable_entities:"Entidades clicáveis",use_new_flow_rate_model:"Usar novo modelo de taxa de fluxo",use_metadata:"Usar metadados",energy_date_selection:"Seleção de data para energia",show:"Mostrar"},xe={card:be,editor:we},ke={label:{car:"Coche",motorbike:"Motocicleta"}},$e={combined:"Entidad Combinada (Una entidad con valores positivos y negativos)",separated:"Entidades Separadas (Una entidad para consumo y otra para producción)",custom_colors:"Colores Personalizados",secondary_info:"Información Secundaria",power_outage:"Corte de Energía",grid:"Red",solar:"Solar",battery:"Batería",fossil_fuel_percentage:"Combustible Fósil",home:"Hogar",individual:"Individual",advanced:"Opciones Avanzadas",decimals:"Decimales",consumption:"Consumo",production:"Producción",color_icon:"Color del Icono",color_circle:"Color del Círculo",color_value:"Color del Valor",color_state_of_charge_value:"Color",display_zero:"Mostrar Cero",display_zero_tolerance:"Tolerancia de Mostrar Cero",display_state:"Mostrar Estado",display_zero_state:"Mostrar Estado Cero",invert_state:"Invertir Estado",template:"Plantilla",unit_of_measurement:"Unidad",unit_white_space:"Espacio en Blanco de la Unidad",label_alert:"Etiqueta para Alerta",icon_alert:"Ícono para Alerta",state_alert:"Estado de Alerta",state_of_charge:"Estado de Carga",state_of_charge_unit_white_space:"Espacio en Blanco de la Unidad",state_of_charge_unit:"Unidad",state_of_charge_decimals:"Decimales",state_of_charge_icon:"Ícono",state_type:"Tipo de Estado",subtract_individual:"Restar Individual",override_state:"Sobrescribir Estado",calculate_flow_rate:"Calcular Tasa de Flujo",inverted_animation:"Animación Invertida",show_direction:"Mostrar Dirección",color:"Color",dashboard_link:"Enlace al Panel de Control",dashboard_link_label:"Nombre del Enlace al Panel de Control",wh_decimals:"Decimales de Watthoras",kwh_decimals:"Decimales de Kilowatthoras",mwh_decimals:"Decimales de Megawatthoras",max_flow_rate:"Tasa Máxima de Flujo",min_flow_rate:"Tasa Mínima de Flujo",max_expected_energy:"Energía Máxima Esperada",min_expected_energy:"Energía Mínima Esperada",wh_kwh_threshold:"Umbral de Watthoras a Kilowatthoras",kwh_mwh_threshold:"Umbral de Kilowatthoras a Megawatthoras",display_zero_lines:"Mostrar Líneas Cero",clickable_entities:"Entidades Clicables",use_new_flow_rate_model:"Nuevo Modelo de Tasa de Flujo",use_metadata:"Usar Metadatos",energy_date_selection:"Selección de Fecha de Energía",show:"Mostrar"},Ee={card:ke,editor:$e},Se={label:{car:"Auto",motorbike:"Motorfiets"}},Ce={combined:"Gecombineerde entiteit (Eén entiteit met positieve en negatieve waarden)",separated:"Gescheiden entiteiten (Eén entiteit voor verbruik en één voor productie)",custom_colors:"Aangepaste kleuren",secondary_info:"Secundaire informatie",power_outage:"Stroomuitval",grid:"Netwerk",solar:"Zonne-energie",battery:"Batterij",fossil_fuel_percentage:"Fossiele brandstof",home:"Thuis",individual:"Individueel",advanced:"Geavanceerde opties",decimals:"Decimalen",consumption:"Verbruik",production:"Productie",color_icon:"Kleur van het pictogram",color_circle:"Kleur van de cirkel",color_value:"Kleur van de waarde",color_state_of_charge_value:"Kleur",display_zero:"Nul weergeven",display_zero_tolerance:"Nultolerantie weergeven",display_state:"Status weergeven",display_zero_state:"Nulstatus weergeven",invert_state:"Status omkeren",template:"Sjabloon",unit_of_measurement:"Eenheid",unit_white_space:"Spatie tussen eenheden",label_alert:"Label voor waarschuwing",icon_alert:"Pictogram voor waarschuwing",state_alert:"Status van waarschuwing",state_of_charge:"Laadstatus",state_of_charge_unit_white_space:"Spatie tussen eenheid en laadstatus",state_of_charge_unit:"Eenheid",state_of_charge_decimals:"Decimalen",state_of_charge_icon:"Pictogram",state_type:"Type status",subtract_individual:"Individueel aftrekken",override_state:"Status overschrijven",calculate_flow_rate:"Stroomsterkte berekenen",inverted_animation:"Omgekeerde animatie",show_direction:"Richting weergeven",color:"Kleur",dashboard_link:"Dashboardlink",dashboard_link_label:"Naam van de dashboardlink",wh_decimals:"Decimalen van watthours",kwh_decimals:"Decimalen van kilowatthours",mwh_decimals:"Decimalen van megawatthours",max_flow_rate:"Maximale stroomsterkte",min_flow_rate:"Minimale stroomsterkte",max_expected_energy:"Maximale verwachte energie",min_expected_energy:"Minimale verwachte energie",wh_kwh_threshold:"Watthour naar kilowatthour drempel",kwh_mwh_threshold:"Kilowatthour naar megawatthour drempel",display_zero_lines:"Nullijnen weergeven",clickable_entities:"Klikbare entiteiten",use_new_flow_rate_model:"Nieuw stroomsterktemodel gebruiken",use_metadata:"Metadata gebruiken",energy_date_selection:"Energie Datumselectie",show:"Weergeven"},Ae={card:Se,editor:Ce},ze={label:{car:"Auto",motorbike:"Motocicletta"}},Me={combined:"Entità combinata (Un'entità con valori positivi e negativi)",separated:"Entità separate (Un'entità per il consumo e una per la produzione)",custom_colors:"Colori personalizzati",secondary_info:"Informazioni secondarie",power_outage:"Interruzione di corrente",grid:"Griglia",solar:"Solare",battery:"Batteria",fossil_fuel_percentage:"Carburante fossile",home:"Casa",individual:"Individuale",advanced:"Opzioni avanzate",decimals:"Decimali",consumption:"Consumo",production:"Produzione",color_icon:"Colore dell'icona",color_circle:"Colore del cerchio",color_value:"Colore del valore",color_state_of_charge_value:"Colore",display_zero:"Mostra zero",display_zero_tolerance:"Tolleranza dello zero",display_state:"Mostra stato",display_zero_state:"Mostra stato zero",invert_state:"Inverti stato",template:"Modello",unit_of_measurement:"Unità",unit_white_space:"Spazio bianco dell'unità",label_alert:"Etichetta per l'allerta",icon_alert:"Icona per l'allerta",state_alert:"Stato dell'allerta",state_of_charge:"Stato di carica",state_of_charge_unit_white_space:"Spazio bianco",state_of_charge_unit:"Unità",state_of_charge_decimals:"Decimali",state_of_charge_icon:"Icona",state_type:"Tipo di stato",subtract_individual:"Sottrai individuale",override_state:"Sovrascrivi stato",calculate_flow_rate:"Calcola il flusso",inverted_animation:"Animazione invertita",show_direction:"Mostra direzione",color:"Colore",dashboard_link:"Collegamento al cruscotto",dashboard_link_label:"Nome del collegamento al cruscotto",wh_decimals:"Decimali di watthora",kwh_decimals:"Decimali di chilowatthora",mwh_decimals:"Decimali di megawatthora",max_flow_rate:"Flusso massimo",min_flow_rate:"Flusso minimo",max_expected_energy:"Energia massima prevista",min_expected_energy:"Energia minima prevista",wh_kwh_threshold:"Soglia di wattora a chilowattora",kwh_mwh_threshold:"Soglia di chilowattora a megawatthora",display_zero_lines:"Mostra linee zero",clickable_entities:"Entità cliccabili",use_new_flow_rate_model:"Usa nuovo modello di flusso",use_metadata:"Usa metadati",energy_date_selection:"Selezione della data energetica",show:"Mostra"},De={card:ze,editor:Me},Pe={label:{car:"Voiture",motorbike:"Moto"}},je={combined:"Entité combinée (Une entité avec des valeurs positives et négatives)",separated:"Entités séparées (Une entité pour la consommation et une pour la production)",custom_colors:"Couleurs personnalisées",secondary_info:"Informations secondaires",power_outage:"Coupure de courant",grid:"Réseau",solar:"Solaire",battery:"Batterie",fossil_fuel_percentage:"Combustible fossile",home:"Accueil",individual:"Individuel",advanced:"Options avancées",decimals:"Décimales",consumption:"Consommation",production:"Production",color_icon:"Couleur de l'icône",color_circle:"Couleur du cercle",color_value:"Couleur de la valeur",color_state_of_charge_value:"Couleur",display_zero:"Afficher zéro",display_zero_tolerance:"Tolérance d'affichage zéro",display_state:"Afficher l'état",display_zero_state:"Afficher l'état zéro",invert_state:"Inverser l'état",template:"Modèle",unit_of_measurement:"Unité",unit_white_space:"Espace blanc de l'unité",label_alert:"Étiquette pour l'alerte",icon_alert:"Icône pour l'alerte",state_alert:"État de l'alerte",state_of_charge:"État de charge",state_of_charge_unit_white_space:"Espace blanc de l'unité",state_of_charge_unit:"Unité",state_of_charge_decimals:"Décimales",state_of_charge_icon:"Icône",state_type:"Type d'état",subtract_individual:"Soustraire l'individuel",override_state:"Remplacer l'état",calculate_flow_rate:"Calculer le débit",inverted_animation:"Animation inversée",show_direction:"Afficher la direction",color:"Couleur",dashboard_link:"Lien du tableau de bord",dashboard_link_label:"Nom du lien du tableau de bord",wh_decimals:"Décimales des Wattheures",kwh_decimals:"Décimales des Kilowattheures",mwh_decimals:"Décimales des Mégawattheures",max_flow_rate:"Débit maximal",min_flow_rate:"Débit minimal",max_expected_energy:"Énergie maximale attendue",min_expected_energy:"Énergie minimale attendue",wh_kwh_threshold:"Seuil de Wattheures à Kilowattheures",kwh_mwh_threshold:"Seuil de Kilowattheures à Mégawattheures",display_zero_lines:"Afficher les lignes zéro",clickable_entities:"Entités cliquables",use_new_flow_rate_model:"Nouveau modèle de débit",use_metadata:"Utiliser les métadonnées",energy_date_selection:"Sélection de la date d'énergie",show:"Afficher"},Oe={card:Pe,editor:je},Te={label:{car:"Автомобиль",motorbike:"Мотоцикл"}},Ne={combined:"Объединенная сущность (Одна сущность с положительными и отрицательными значениями)",separated:"Раздельные сущности (Одна сущность для потребления и одна для производства)",custom_colors:"Пользовательские цвета",secondary_info:"Дополнительная информация",power_outage:"Отключение электропитания",grid:"Сеть",solar:"Солнечная энергия",battery:"Батарея",fossil_fuel_percentage:"Доля ископаемого топлива",home:"Дом",individual:"Индивидуальный",advanced:"Расширенные настройки",decimals:"Десятичные знаки",consumption:"Потребление",production:"Производство",color_icon:"Цвет значка",color_circle:"Цвет круга",color_value:"Цвет значения",color_state_of_charge_value:"Цвет",display_zero:"Отображать ноль",display_zero_tolerance:"Отображать ноль с погрешностью",display_state:"Отображать состояние",display_zero_state:"Отображать состояние ноль",invert_state:"Инвертировать состояние",template:"Шаблон",unit_of_measurement:"Единица измерения",unit_white_space:"Пробел между единицами измерения",label_alert:"Метка для предупреждения",icon_alert:"Значок для предупреждения",state_alert:"Состояние предупреждения",state_of_charge:"Уровень заряда",state_of_charge_unit_white_space:"Пробел между единицей измерения и уровнем заряда",state_of_charge_unit:"Единица измерения",state_of_charge_decimals:"Десятичные знаки",state_of_charge_icon:"Значок",state_type:"Тип состояния",subtract_individual:"Вычесть индивидуальное",override_state:"Переопределить состояние",calculate_flow_rate:"Расчет скорости потока",inverted_animation:"Инвертированная анимация",show_direction:"Отображать направление",color:"Цвет",dashboard_link:"Ссылка на панель управления",dashboard_link_label:"Название ссылки на панель управления",wh_decimals:"Десятичные знаки ватт-часов",kwh_decimals:"Десятичные знаки киловатт-часов",mwh_decimals:"Десятичные знаки мегаватт-часов",max_flow_rate:"Максимальная скорость потока",min_flow_rate:"Минимальная скорость потока",max_expected_energy:"Максимальная ожидаемая энергия",min_expected_energy:"Минимальная ожидаемая энергия",wh_kwh_threshold:"Порог ватт-часов к киловатт-часам",kwh_mwh_threshold:"Порог киловатт-часов к мегаватт-часам",display_zero_lines:"Отображать нулевые линии",clickable_entities:"Кликабельные сущности",use_new_flow_rate_model:"Использовать новую модель скорости потока",use_metadata:"Использовать метаданные",energy_date_selection:"Выбор даты энергии",show:"Показать"},Ue={card:Te,editor:Ne},Be={label:{car:"Auto",motorbike:"Moottoripyörä"}},Ge={combined:"Yhdistetty yksikkö (Yksi yksikkö positiivisilla ja negatiivisilla arvoilla)",separated:"Eroitetut yksiköt (Yksi yksikkö kulutusta ja yksi tuotantoa varten)",custom_colors:"Mukautetut värit",secondary_info:"Toissijaiset tiedot",power_outage:"Sähkökatko",grid:"Verkko",solar:"Aurinko",battery:"Akku",fossil_fuel_percentage:"Fossiiliset polttoaineet",home:"Koti",individual:"Yksilöllinen",advanced:"Lisäasetukset",decimals:"Desimaalit",consumption:"Kulutus",production:"Tuotanto",color_icon:"Symbolin väri",color_circle:"Ympyrän väri",color_value:"Arvon väri",color_state_of_charge_value:"Väri",display_zero:"Näytä nolla",display_zero_tolerance:"Nollatoleranssi",display_state:"Näytä tila",display_zero_state:"Näytä nollatila",invert_state:"Käänteinen tila",template:"Malli",unit_of_measurement:"Yksikkö",unit_white_space:"Yksikön välilyönti",label_alert:"Varoituksen nimi",icon_alert:"Varoituksen symboli",state_alert:"Varoitustila",state_of_charge:"Lataustila",state_of_charge_unit_white_space:"Välilyönti",state_of_charge_unit:"Yksikkö",state_of_charge_decimals:"Desimaalit",state_of_charge_icon:"Symboli",state_type:"Tilan tyyppi",subtract_individual:"Vähennä yksilöllinen",override_state:"Ohita tila",calculate_flow_rate:"Laske virtausnopeus",inverted_animation:"Käänteinen animaatio",show_direction:"Näytä suunta",color:"Väri",dashboard_link:"Ohjauspaneelin linkki",dashboard_link_label:"Ohjauspaneelin linkin nimi",wh_decimals:"Watittunnin desimaalit",kwh_decimals:"Kilowattitunnin desimaalit",mwh_decimals:"Megawattitunnin desimaalit",max_flow_rate:"Suurin virtausnopeus",min_flow_rate:"Pienin virtausnopeus",max_expected_energy:"Suurin odotettu energia",min_expected_energy:"Pienin odotettu energia",wh_kwh_threshold:"Watittuntien ja kilowattituntien raja-arvo",kwh_mwh_threshold:"Kilowattituntien ja megawattituntien raja-arvo",display_zero_lines:"Näytä nollalinjat",clickable_entities:"Napsautettavat yksiköt",use_new_flow_rate_model:"Käytä uutta virtausnopeuden mallia",use_metadata:"Käytä metatietoja",energy_date_selection:"Energian päivämäärän valinta",show:"Näytä"},Ie={card:Be,editor:Ge},He={label:{car:"Samochód",motorbike:"Motocykl"}},Fe={combined:"Połączona jednostka (Jednostka z wartościami dodatnimi i ujemnymi)",separated:"Oddzielne jednostki (Jednostka dla zużycia i jednostka dla produkcji)",custom_colors:"Niestandardowe kolory",secondary_info:"Dodatkowe informacje",power_outage:"Przerwa w dostawie prądu",grid:"Sieć",solar:"Energia słoneczna",battery:"Bateria",fossil_fuel_percentage:"Paliwo kopalne",home:"Dom",individual:"Indywidualne",advanced:"Zaawansowane opcje",decimals:"Miejsca dziesiętne",consumption:"Zużycie",production:"Produkcja",color_icon:"Kolor ikony",color_circle:"Kolor okręgu",color_value:"Kolor wartości",color_state_of_charge_value:"Kolor",display_zero:"Wyświetl zero",display_zero_tolerance:"Tolerancja zera",display_state:"Wyświetl stan",display_zero_state:"Wyświetl stan zero",invert_state:"Odwróć stan",template:"Szablon",unit_of_measurement:"Jednostka",unit_white_space:"Przerwa między jednostkami",label_alert:"Etykieta dla alertu",icon_alert:"Ikona dla alertu",state_alert:"Stan alertu",state_of_charge:"Stan naładowania",state_of_charge_unit_white_space:"Przerwa między jednostkami",state_of_charge_unit:"Jednostka",state_of_charge_decimals:"Miejsca dziesiętne",state_of_charge_icon:"Ikona",state_type:"Typ stanu",subtract_individual:"Odjęcie indywidualne",override_state:"Nadpisanie stanu",calculate_flow_rate:"Oblicz szybkość przepływu",inverted_animation:"Animacja odwrócona",show_direction:"Pokaż kierunek",color:"Kolor",dashboard_link:"Link do pulpitu",dashboard_link_label:"Nazwa linku do pulpitu",wh_decimals:"Miejsca dziesiętne watogodzin",kwh_decimals:"Miejsca dziesiętne kilowatogodzin",mwh_decimals:"Miejsca dziesiętne megawatogodzin",max_flow_rate:"Maksymalna szybkość przepływu",min_flow_rate:"Minimalna szybkość przepływu",max_expected_energy:"Maksymalna spodziewana energia",min_expected_energy:"Minimalna spodziewana energia",wh_kwh_threshold:"Próg watogodzin na kilowatogodziny",kwh_mwh_threshold:"Próg kilowatogodzin na megawatogodziny",display_zero_lines:"Wyświetl linie zera",clickable_entities:"Klikalne jednostki",use_new_flow_rate_model:"Użyj nowego modelu szybkości przepływu",use_metadata:"Użyj metadanych",energy_date_selection:"Wybór daty dla energii",show:"Pokaż"},Re={card:He,editor:Fe};const Le={en:Object.freeze({__proto__:null,card:ue,editor:he,default:ve}),de:Object.freeze({__proto__:null,card:_e,editor:pe,default:me}),pt:Object.freeze({__proto__:null,card:ye,editor:ge,default:fe}),pt_BR:Object.freeze({__proto__:null,card:be,editor:we,default:xe}),es:Object.freeze({__proto__:null,card:ke,editor:$e,default:Ee}),nl:Object.freeze({__proto__:null,card:Se,editor:Ce,default:Ae}),it:Object.freeze({__proto__:null,card:ze,editor:Me,default:De}),fr:Object.freeze({__proto__:null,card:Pe,editor:je,default:Oe}),ru:Object.freeze({__proto__:null,card:Te,editor:Ne,default:Ue}),fi:Object.freeze({__proto__:null,card:Be,editor:Ge,default:Ie}),pl:Object.freeze({__proto__:null,card:He,editor:Fe,default:Re})},We="en";function Ve(e,t){try{return e.split(".").reduce(((e,t)=>e[t]),Le[t])}catch(e){return}}function Ke(e){let t=Ve(e,(localStorage.getItem("selectedLanguage")||"en").replace(/['"]+/g,"").replace("-","_"));return t||(t=Ve(e,We)),null!=t?t:e}var Ze,Ye;function qe(){return(qe=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var o=arguments[t];for(var i in o)Object.prototype.hasOwnProperty.call(o,i)&&(e[i]=o[i])}return e}).apply(this,arguments)}!function(e){e.language="language",e.system="system",e.comma_decimal="comma_decimal",e.decimal_comma="decimal_comma",e.space_comma="space_comma",e.none="none"}(Ze||(Ze={})),function(e){e.language="language",e.system="system",e.am_pm="12",e.twenty_four="24"}(Ye||(Ye={}));var Je=function(e,t){return void 0===t&&(t=2),Math.round(e*Math.pow(10,t))/Math.pow(10,t)},Qe=function(e,t,o){var i=t?function(e){switch(e.number_format){case Ze.comma_decimal:return["en-US","en"];case Ze.decimal_comma:return["de","es","it"];case Ze.space_comma:return["fr","sv","cs"];case Ze.system:return;default:return e.language}}(t):void 0;if(Number.isNaN=Number.isNaN||function e(t){return"number"==typeof t&&e(t)},(null==t?void 0:t.number_format)!==Ze.none&&!Number.isNaN(Number(e))&&Intl)try{return new Intl.NumberFormat(i,Xe(e,o)).format(Number(e))}catch(t){return console.error(t),new Intl.NumberFormat(void 0,Xe(e,o)).format(Number(e))}return"string"==typeof e?e:Je(e,null==o?void 0:o.maximumFractionDigits).toString()+("currency"===(null==o?void 0:o.style)?" "+o.currency:"")},Xe=function(e,t){var o=qe({maximumFractionDigits:2},t);if("string"!=typeof e)return o;if(!t||!t.minimumFractionDigits&&!t.maximumFractionDigits){var i=e.indexOf(".")>-1?e.split(".")[1].length:0;o.minimumFractionDigits=i,o.maximumFractionDigits=i}return o};function et(e){return!isNaN(parseFloat(e))&&!isNaN(Number(e))}function tt(e,t=0){return et(e)?Number(e):t}const ot=t=>{class o extends t{connectedCallback(){super.connectedCallback(),this.__checkSubscribed()}disconnectedCallback(){super.disconnectedCallback(),this.hassUnsubscribe()}updated(e){super.updated(e),e.has("hass")&&this.__checkSubscribed()}resetSubscriptions(){this.hassUnsubscribe(),this.__checkSubscribed()}hassSubscribe(){return[]}hassUnsubscribe(){if(this.__unsubs){for(;this.__unsubs.length;){const e=this.__unsubs.pop();e instanceof Promise?e.then((e=>e())):e()}this.__unsubs=void 0}}__checkSubscribed(){void 0===this.__unsubs&&this.isConnected&&void 0!==this.hass&&(this.__unsubs=this.hassSubscribe())}}return e([se({attribute:!1})],o.prototype,"hass",void 0),o};function it(e){return it="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},it(e)}function at(e){if(null===e||!0===e||!1===e)return NaN;var t=Number(e);return isNaN(t)?t:t<0?Math.ceil(t):Math.floor(t)}function rt(e,t){if(t.length<e)throw new TypeError(e+" argument"+(e>1?"s":"")+" required, but only "+t.length+" present")}function nt(e){rt(1,arguments);var t=Object.prototype.toString.call(e);return e instanceof Date||"object"===it(e)&&"[object Date]"===t?new Date(e.getTime()):"number"==typeof e||"[object Number]"===t?new Date(e):("string"!=typeof e&&"[object String]"!==t||"undefined"==typeof console||(console.warn("Starting with v2.0.0-beta.1 date-fns doesn't accept strings as date arguments. Please use `parseISO` to parse strings. See: https://github.com/date-fns/date-fns/blob/master/docs/upgradeGuide.md#string-arguments"),console.warn((new Error).stack)),new Date(NaN))}var lt=36e5;function st(e,t){return rt(2,arguments),function(e,t){rt(2,arguments);var o=nt(e).getTime(),i=at(t);return new Date(o+i)}(e,at(t)*lt)}function dt(e){var t=new Date(Date.UTC(e.getFullYear(),e.getMonth(),e.getDate(),e.getHours(),e.getMinutes(),e.getSeconds(),e.getMilliseconds()));return t.setUTCFullYear(e.getFullYear()),e.getTime()-t.getTime()}function ct(e){rt(1,arguments);var t=nt(e);return t.setHours(0,0,0,0),t}var ut=864e5;function ht(e,t){var o=e.getFullYear()-t.getFullYear()||e.getMonth()-t.getMonth()||e.getDate()-t.getDate()||e.getHours()-t.getHours()||e.getMinutes()-t.getMinutes()||e.getSeconds()-t.getSeconds()||e.getMilliseconds()-t.getMilliseconds();return o<0?-1:o>0?1:o}function vt(e,t){rt(2,arguments);var o=nt(e),i=nt(t),a=ht(o,i),r=Math.abs(function(e,t){rt(2,arguments);var o=ct(e),i=ct(t),a=o.getTime()-dt(o),r=i.getTime()-dt(i);return Math.round((a-r)/ut)}(o,i));o.setDate(o.getDate()-a*r);var n=a*(r-Number(ht(o,i)===-a));return 0===n?0:n}const _t=(e,t="_energy")=>e.connection[t]?e.connection[t]:null,pt=e=>{if(!e||e.length<2)return null;const t=e[e.length-1].sum;if(null===t)return null;const o=e[0].sum;return null===o?t:t-o};const mt=1;class yt{constructor(e){}get _$AU(){return this._$AM._$AU}_$AT(e,t,o){this._$Ct=e,this._$AM=t,this._$Ci=o}_$AS(e,t){return this.update(e,t)}update(e,t){return this.render(...t)}}const gt=(e=>(...t)=>({_$litDirective$:e,values:t}))(class extends yt{constructor(e){var t;if(super(e),e.type!==mt||"class"!==e.name||(null===(t=e.strings)||void 0===t?void 0:t.length)>2)throw Error("`classMap()` can only be used in the `class` attribute and must be the only part in the attribute.")}render(e){return" "+Object.keys(e).filter((t=>e[t])).join(" ")+" "}update(e,[t]){var o,i;if(void 0===this.it){this.it=new Set,void 0!==e.strings&&(this.nt=new Set(e.strings.join(" ").split(/\s/).filter((e=>""!==e))));for(const e in t)t[e]&&!(null===(o=this.nt)||void 0===o?void 0:o.has(e))&&this.it.add(e);return this.render(t)}const a=e.element.classList;this.it.forEach((e=>{e in t||(a.remove(e),this.it.delete(e))}));for(const e in t){const o=!!t[e];o===this.it.has(e)||(null===(i=this.nt)||void 0===i?void 0:i.has(e))||(o?(a.add(e),this.it.add(e)):(a.remove(e),this.it.delete(e)))}return I}});var ft="0.1.2.1";console.groupCollapsed(`%c⚡ Energy Flow Card Plus v${ft} is installed`,"color: #488fc2; font-weight: bold"),console.log("Readme:","https://github.com/flixlix/energy-flow-card-plus"),console.groupEnd();const bt=function(e,t,o){var i;return void 0===o&&(o=!1),function(){var a=[].slice.call(arguments),r=this,n=o&&!i;clearTimeout(i),i=setTimeout((function(){i=null,o||e.apply(r,a)}),t),n&&e.apply(r,a)}}((e=>{console.log(`%c⚡ Energy Flow Card Plus v${ft} %cError: ${e}`,"color: #488fc2; font-weight: bold","color: #b33a3a; font-weight: normal")}),6e4),wt=n`:host{--mdc-icon-size:24px;--clickable-cursor:pointer;--individualone-color:#d0cc5b;--individualtwo-color:#964cb5;--non-fossil-color:var(--energy-non-fossil-color, #0f9d58);--icon-non-fossil-color:var(--non-fossil-color, #0f9d58);--icon-solar-color:var(--energy-solar-color, #ff9800);--icon-individualone-color:var(--individualone-color, #d0cc5b);--icon-individualtwo-color:var(--individualtwo-color, #964cb5);--icon-grid-color:var(--energy-grid-consumption-color, #488fc2);--icon-battery-color:var(--energy-battery-in-color, #f06292);--icon-home-color:var(--energy-grid-consumption-color, #488fc2);--text-solar-color:var(--primary-text-color);--text-non-fossil-color:var(--primary-text-color);--text-individualone-color:var(--primary-text-color);--text-individualtwo-color:var(--primary-text-color);--text-home-color:var(--primary-text-color);--secondary-text-individualone-color:var(--primary-text-color);--secondary-text-individualtwo-color:var(--primary-text-color);--text-battery-state-of-charge-color:var(--primary-text-color);--cirlce-grid-color:var(--energy-grid-consumption-color, #488fc2);--circle-battery-color:var(--energy-battery-in-color, #f06292);--secondary-text-solar-color:var(--primary-text-color);--secondary-text-grid-color:var(--primary-text-color);--secondary-text-home-color:var(--primary-text-color);--secondary-text-non-fossil-color:var(--primary-text-color);--lines-svg-not-flat-line-height:106%;--lines-svg-not-flat-line-top:-3%;--lines-svg-flat-width:calc(100% - 160px);--lines-svg-not-flat-width:calc(103% - 165px)}.card-content{position:relative;margin:0 auto}.card-content,.row{max-width:470px}.lines{position:absolute;bottom:0;left:0;width:100%;height:146px;display:flex;justify-content:center;padding:0 16px 16px;box-sizing:border-box}.lines.individual1-individual2{bottom:110px}.lines.high{bottom:100px;height:156px}.lines svg{width:var(--lines-svg-flat-width);height:100%;max-width:340px}.lines svg:not(.flat-line){width:var(--lines-svg-not-flat-width);height:var(--lines-svg-not-flat-line-height);top:var(--lines-svg-not-flat-line-top);position:relative}.row{display:flex;justify-content:space-between;max-width:500px;margin:0 auto}.circle-container{display:flex;flex-direction:column;align-items:center;z-index:2}.circle-container.solar{margin:0 4px;height:130px}.circle-container.individual2{margin-left:4px;height:130px}.circle-container.individual1{margin-left:4px;height:130px}.circle-container.individual1.bottom{position:relative;top:-20px;margin-bottom:-20px}.circle-container.battery{height:110px;justify-content:flex-end}.spacer{width:84px}.circle{width:80px;height:80px;border-radius:50%;box-sizing:border-box;border:2px solid;display:flex;flex-direction:column;align-items:center;justify-content:center;text-align:center;font-size:12px;line-height:12px;position:relative;text-decoration:none;color:var(--primary-text-color)}.circle-container .circle{cursor:var(--clickable-cursor)}#battery-grid{stroke:var(--energy-grid-return-color)}ha-icon{padding-bottom:2px}ha-icon.small{--mdc-icon-size:12px}.label{color:var(--secondary-text-color);font-size:12px;max-width:80px;text-overflow:ellipsis;white-space:nowrap;overflow:hidden}line,path{stroke:var(--disabled-text-color);stroke-width:1;fill:none}.circle svg{position:absolute;fill:none;stroke-width:4px;width:100%;height:100%;top:0;left:0}span.secondary-info{color:var(--primary-text-color);font-size:12px;max-width:60px;text-overflow:ellipsis;white-space:nowrap;overflow:hidden}.individual2 circle,.individual2 path{stroke:var(--individualtwo-color)}#individual1-icon{color:var(--icon-individualone-color)}#individual2-icon{color:var(--icon-individualtwo-color)}#solar-icon{color:var(--icon-solar-color)}circle.individual2{stroke-width:4;fill:var(--individualtwo-color)}.individual2 .circle{border-color:var(--individualtwo-color)}.individual1 circle,.individual1 path{stroke:var(--individualone-color)}circle.individual1{stroke-width:4;fill:var(--individualone-color)}.individual1 .circle{border-color:var(--individualone-color)}.circle-container.low-carbon{margin-right:4px;height:130px}.low-carbon path{stroke:var(--non-fossil-color)}.low-carbon .circle{border-color:var(--non-fossil-color)}.low-carbon ha-icon:not(.small){color:var(--icon-non-fossil-color)}circle.low-carbon{stroke-width:4;fill:var(--non-fossil-color);stroke:var(--non-fossil-color)}.solar{color:var(--primary-text-color)}.solar .circle{border-color:var(--energy-solar-color)}.solar ha-icon:not(.small){color:var(--icon-solar-color)}circle.solar,path.solar{stroke:var(--energy-solar-color)}circle.solar{stroke-width:4;fill:var(--energy-solar-color)}.battery .circle{border-color:var(--circle-battery-color)}circle.battery,path.battery{stroke:var(--energy-battery-out-color)}circle.battery-home,path.battery-home{stroke:var(--energy-battery-out-color)}circle.battery-home{stroke-width:4;fill:var(--energy-battery-out-color)}circle.battery-solar,path.battery-solar{stroke:var(--energy-battery-in-color)}circle.battery-solar{stroke-width:4;fill:var(--energy-battery-in-color)}.battery-in{color:var(--energy-battery-in-color)}.battery-out{color:var(--energy-battery-out-color)}path.battery-from-grid{stroke:var(--energy-grid-consumption-color)}path.battery-to-grid{stroke:var(--energy-grid-return-color)}.battery ha-icon:not(.small){color:var(--icon-battery-color)}circle.battery-to-grid,circle.return,path.return{stroke:var(--energy-grid-return-color)}circle.battery-to-grid,circle.return{stroke-width:4;fill:var(--energy-grid-return-color)}.return{color:var(--energy-grid-return-color)}.grid .circle{border-color:var(--circle-grid-color)}.consumption{color:var(--energy-grid-consumption-color)}circle.battery-from-grid,circle.grid,path.grid{stroke:var(--energy-grid-consumption-color)}circle.battery-from-grid,circle.grid{stroke-width:4;fill:var(--energy-grid-consumption-color)}.grid ha-icon:not(.small){color:var(--icon-grid-color)}.home .circle{border-width:0;border-color:var(--primary-color)}.home .circle.border{border-width:2px}.home ha-icon:not(.small){color:var(--icon-home-color)}.circle svg circle{animation:rotate-in .6s ease-in;transition:stroke-dashoffset .4s,stroke-dasharray .4s;fill:none}span.solar{color:var(--text-solar-color)}span.low-carbon{color:var(--text-non-fossil-color)}span.low-carbon.secondary-info{color:var(--secondary-text-non-fossil-color)}#home-circle{color:var(--text-home-color)}.individual1 .circle{color:var(--text-individualone-color)}.individual2 .circle{color:var(--text-individualtwo-color)}.individual1 span.secondary-info{color:var(--secondary-text-individualone-color)}.individual2 span.secondary-info{color:var(--secondary-text-individualtwo-color)}.solar span.secondary-info{color:var(--secondary-text-solar-color)}.grid span.secondary-info{color:var(--secondary-text-grid-color)}.home span.secondary-info{color:var(--secondary-text-home-color)}#battery-state-of-charge-text{color:var(--text-battery-state-of-charge-color)}@keyframes rotate-in{from{stroke-dashoffset:238.76104;stroke-dasharray:238.76104}}.card-actions a{text-decoration:none}.home-circle-sections{pointer-events:none}`,xt=6,kt=1,$t=1,Et=0,St=0,Ct=10,At=2e3,zt=1e3,Mt=1e3;!function(e){const t=window;t.customCards=t.customCards||[],t.customCards.push(Object.assign(Object.assign({},e),{preview:!0,documentationURL:"https://github.com/flixlix/energy-flow-card-plus"}))}({type:"energy-flow-card-plus",name:"Energy Flow Card Plus",description:"A custom card for displaying energy flow in Home Assistant. Inspired by the official Energy Distribution Card."});const Dt=238.76104;let Pt=class extends(ot(ae)){constructor(){super(...arguments),this.states={},this.entitiesArr=[],this._width=0,this.unavailableOrMisconfiguredError=e=>bt(`Entity "${null!=e?e:"Unknown"}" is not available or misconfigured`),this.entityExists=e=>e in this.hass.states,this.entityAvailable=(e,t)=>{var o,i,a;return(null===(o=this._config)||void 0===o?void 0:o.energy_date_selection)&&!0!==t?et(null===(i=this.states[e])||void 0===i?void 0:i.state):et(null===(a=this.hass.states[e])||void 0===a?void 0:a.state)},this.entityInverted=e=>{var t;return!!(null===(t=this._config.entities[e])||void 0===t?void 0:t.invert_state)},this.previousDur={},this.circleRate=(e,t)=>{const o=this._config.max_flow_rate,i=this._config.min_flow_rate;if(this._config.use_new_flow_rate_model){const t=this._config.max_expected_energy,a=this._config.min_expected_energy;return this.mapRange(e,o,i,a,t)}return o-e/t*(o-i)},this.getEntityStateObj=e=>{if(e&&this.entityAvailable(e,!0))return this.hass.states[e];this.unavailableOrMisconfiguredError(e)},this.additionalCircleRate=(e,t)=>!0===e&&t?t:et(e)?e:1.66,this.getEntityState=(e,t)=>{var o,i;if(!e||!this.entityAvailable(e,t))return this.unavailableOrMisconfiguredError(e),0;return tt((!1===(null===(o=this._config)||void 0===o?void 0:o.energy_date_selection)||t?null===(i=this.hass)||void 0===i?void 0:i.states[e]:this.states[e]).state)},this.getEntityStateWatthours=(e,t)=>{let o=[];"string"==typeof e?o.push(e):Array.isArray(e)&&(o=e);const i=o.map((e=>{var o,i,a,r;let n;e&&this.entityAvailable(e)||this.unavailableOrMisconfiguredError(e),n=void 0===t?!1!==this._config.energy_date_selection?this.states[e]:null===(o=this.hass)||void 0===o?void 0:o.states[e]:t?null===(i=this.hass)||void 0===i?void 0:i.states[e]:this.states[e];const l=tt(null==n?void 0:n.state);return(null===(a=null==n?void 0:n.attributes.unit_of_measurement)||void 0===a?void 0:a.toUpperCase().startsWith("KWH"))?1e3*l:(null===(r=null==n?void 0:n.attributes.unit_of_measurement)||void 0===r?void 0:r.toUpperCase().startsWith("MWH"))?1e6*l:l}));return i.reduce(((e,t)=>e+t),0)},this.displayValue=(e,t,o,i)=>{if(null===e)return"0";if(Number.isNaN(+e))return e.toString();const a=Number(e),r=void 0===t&&a/1e3>=this._config.kwh_mwh_threshold,n=void 0===t&&a>=this._config.wh_kwh_threshold;return`${Qe(r?Je(a/1e6,this._config.mwh_decimals):n?Je(a/1e3,this._config.kwh_decimals):Je(a,null!=i?i:this._config.wh_decimals),this.hass.locale)}${!1===o?"":" "}${t||(r?"MWh":n?"kWh":"Wh")}`},this.getSecondaryState=(e,t)=>{if(e.has){const o=null==e?void 0:e.entity,i=!0!==(null==e?void 0:e.energyDateSelection),a=o&&this.getEntityStateWatthours(o,i);if("number"==typeof a)return this.entityInverted(t)?Math.abs(Math.min(a,0)):Math.max(a,0);if("string"==typeof a)return a}return null}}static getStubConfig(e){return function(e){var t,o,i,a;function r(t,o){const i=e.states[t].attributes.friendly_name;return o.some((e=>t.includes(e)||(null==i?void 0:i.includes(e))))}const n=Object.keys(e.states).filter((t=>{const o=e.states[t];return o.state&&o.attributes&&"energy"===o.attributes.device_class||o.entity_id.includes("energy")})),l=["grid","utility","net","meter"],s=["solar","pv","photovoltaic","inverter"],d=["battery"],c=n.filter((e=>r(e,d))),u=n.filter((e=>r(e,l))),h=n.filter((e=>r(e,s)))[0];return{type:"custom:energy-flow-card-plus",entities:{battery:{entity:{consumption:null!==(t=c[0])&&void 0!==t?t:"",production:null!==(o=c[1])&&void 0!==o?o:""}},grid:{entity:{consumption:null!==(i=u[0])&&void 0!==i?i:"",production:null!==(a=u[1])&&void 0!==a?a:""}},solar:h?{entity:h,display_zero_state:!0}:void 0},clickable_entities:!0,display_zero_lines:!0,use_new_flow_rate_model:!0,energy_date_selection:!0,wh_decimals:$t,kwh_decimals:Et,min_flow_rate:kt,max_flow_rate:xt,max_expected_energy:At,min_expected_energy:Ct,wh_kwh_threshold:zt}}(e)}static async getConfigElement(){return await Promise.resolve().then((function(){return bo})),document.createElement("energy-flow-card-plus-editor")}hassSubscribe(){var e;if(!1===(null===(e=this._config)||void 0===e?void 0:e.energy_date_selection))return[];const t=Date.now(),o=(e,i)=>{const a=_t(this.hass);a?e(a):Date.now()-t>1e4?(console.debug(_t(this.hass)),i(new Error("No energy data received. Make sure to add a `type: energy-date-selection` card to this screen."))):setTimeout((()=>o(e,i)),100)},i=new Promise(o);return setTimeout((()=>{this.error||Object.keys(this.states).length||(this.error=new Error("Something went wrong. No energy data received."),console.debug(_t(this.hass)))}),2e4),i.catch((e=>{this.error=e})),[i.then((async e=>e.subscribe((async e=>{if(this._data=e,this.entitiesArr){const t=await async function(e,t,o){const i=vt(t.end||new Date,t.start),a=st(t.start,-1),r=i>35?"month":i>2?"day":"hour",n=await((e,t,o,i,a="hour")=>e.callWS({type:"recorder/statistics_during_period",start_time:t.toISOString(),end_time:null==o?void 0:o.toISOString(),statistic_ids:i,period:a}))(e,a,t.end,o,r);return Object.values(n).forEach((e=>{e.length&&new Date(e[0].start)>a&&e.unshift(Object.assign(Object.assign({},e[0]),{start:a.toISOString(),end:a.toISOString(),sum:0,state:0}))})),o.reduce(((e,t)=>Object.assign(Object.assign({},e),{[t]:pt(n[t])})),{})}(this.hass,e,this.entitiesArr),o={};Object.keys(t).forEach((e=>{this.hass.states[e]&&(o[e]=Object.assign(Object.assign({},this.hass.states[e]),{state:String(t[e])}))})),this.states=o}}))))]}setConfig(e){var t,o,i,a,r,n;if("object"!=typeof e)throw new Error(Ke("common.invalid_configuration"));if(!e.entities||!(null===(o=null===(t=e.entities)||void 0===t?void 0:t.battery)||void 0===o?void 0:o.entity)&&!(null===(a=null===(i=e.entities)||void 0===i?void 0:i.grid)||void 0===a?void 0:a.entity)&&!(null===(n=null===(r=e.entities)||void 0===r?void 0:r.solar)||void 0===n?void 0:n.entity))throw new Error("At least one entity for battery, grid or solar must be defined");this._config=Object.assign(Object.assign({},e),{min_flow_rate:tt(e.min_flow_rate,kt),max_flow_rate:tt(e.max_flow_rate,xt),wh_decimals:tt(e.wh_decimals,$t),kwh_decimals:tt(e.kwh_decimals,Et),mwh_decimals:tt(e.mwh_decimals,St),wh_kwh_threshold:tt(e.wh_kwh_threshold,zt),kwh_mwh_threshold:tt(e.kwh_mwh_threshold,Mt),max_expected_energy:tt(e.max_expected_energy,At),min_expected_energy:tt(e.min_expected_energy,Ct)}),this.populateEntitiesArr(),this.resetSubscriptions()}populateEntitiesArr(){var e;this.entitiesArr=[],Object.keys(null===(e=this._config)||void 0===e?void 0:e.entities).forEach((e=>{var t,o,i,a,r,n;"string"==typeof this._config.entities[e].entity||Array.isArray(this._config.entities[e].entity)?Array.isArray(this._config.entities[e].entity)?this._config.entities[e].entity.forEach((e=>{this.entitiesArr.push(e)})):this.entitiesArr.push(this._config.entities[e].entity):"object"==typeof this._config.entities[e].entity&&(Array.isArray(null===(t=this._config.entities[e].entity)||void 0===t?void 0:t.consumption)?null===(o=this._config.entities[e].entity)||void 0===o||o.consumption.forEach((e=>{this.entitiesArr.push(e)})):this.entitiesArr.push(null===(i=this._config.entities[e].entity)||void 0===i?void 0:i.consumption),Array.isArray(null===(a=this._config.entities[e].entity)||void 0===a?void 0:a.production)?null===(r=this._config.entities[e].entity)||void 0===r||r.production.forEach((e=>{this.entitiesArr.push(e)})):this.entitiesArr.push(null===(n=this._config.entities[e].entity)||void 0===n?void 0:n.production))})),this.entitiesArr=this.entitiesArr.filter((e=>void 0!==e))}getCardSize(){return 3}mapRange(e,t,o,i,a){return e>a?o:(e-i)*(o-t)/(a-i)+t}openDetails(e,t){if(e.stopPropagation(),!t||!this._config.clickable_entities)return;if(!this.entityExists(t))return;const o=new CustomEvent("hass-more-info",{composed:!0,detail:{entityId:t}});this.dispatchEvent(o)}hasField(e,t){var o,i;return!!(void 0!==e&&!0===(null==e?void 0:e.display_zero)||(this.getEntityStateWatthours(null==e?void 0:e.entity)>(null!==(o=null==e?void 0:e.display_zero_tolerance)&&void 0!==o?o:0)&&Array.isArray(null==e?void 0:e.entity)?this.entityAvailable(null==e?void 0:e.mainEntity):this.entityAvailable(null==e?void 0:e.entity))||t)&&"string"==typeof(null===(i=this.hass.states[null==e?void 0:e.entity])||void 0===i?void 0:i.state)}showLine(e){var t;return!1!==(null===(t=this._config)||void 0===t?void 0:t.display_zero_lines)||e>0}computeFieldIcon(e,t){var o,i;return(null==e?void 0:e.icon)?e.icon:(null==e?void 0:e.use_metadata)?(null===(i=null===(o=this.getEntityStateObj(e.entity))||void 0===o?void 0:o.attributes)||void 0===i?void 0:i.icon)||"":t}computeFieldName(e,t){var o,i;return(null==e?void 0:e.name)?e.name:(null==e?void 0:e.use_metadata)?(null===(i=null===(o=this.getEntityStateObj(e.entity))||void 0===o?void 0:o.attributes)||void 0===i?void 0:i.friendly_name)||"":t}convertColorListToHex(e){return"#".concat(e.map((e=>e.toString(16).padStart(2,"0"))).join(""))}render(){var e,t,o,i,a,r,n,l,s,d,c,u,h,v,_,p,m,y,g,f,b,w,x,k,$,E,S,C,A,z,M,D,P,j,O,T,N,U,I,H,F,R,L,W,V,K,Z,Y,q,J,Q,X,ee,te,oe,ie,ae,re,ne,le,se,de,ce,ue,he,ve,_e,pe,me,ye,ge,fe,be,we,xe,ke,$e,Ee,Se,Ce,Ae,ze,Me,De,Pe,je,Oe,Te,Ne,Ue,Be,Ge,Ie,He,Fe,Re,Le,We,Ve,Ze,Ye,qe,Je,Qe,Xe,ot,it,at,rt,nt,lt,st,dt,ct,ut,ht,vt,_t,pt,mt,yt,ft,bt,wt,xt,kt,$t,Et,St,Ct,At,zt,Mt,Pt,jt,Ot,Tt,Nt,Ut,Bt,Gt,It,Ht,Ft,Rt,Lt,Wt,Vt,Kt,Zt,Yt,qt,Jt,Qt,Xt,eo,to,oo,io,ao,ro,no,lo,so,co,uo,ho,vo,_o,po,mo,yo,go,fo,bo,wo,xo,ko,$o,Eo,So,Co,Ao,zo,Mo,Do,Po,jo,Oo,To,No,Uo,Bo,Go,Io,Ho,Fo,Ro,Lo,Wo,Vo,Ko,Zo,Yo,qo,Jo,Qo,Xo,ei,ti,oi,ii,ai,ri,ni,li,si,di,ci,ui,hi,vi,_i,pi,mi,yi,gi,fi,bi,wi,xi,ki,$i,Ei,Si,Ci,Ai,zi,Mi,Di,Pi,ji,Oi,Ti,Ni,Ui,Bi,Gi,Ii,Hi,Fi,Ri,Li,Wi,Vi,Ki,Zi,Yi,qi,Ji,Qi,Xi,ea,ta,oa,ia,aa,ra,na,la,sa,da,ca,ua,ha,va,_a,pa,ma,ya,ga,fa,ba,wa,xa,ka,$a,Ea,Sa,Ca,Aa,za;if(!this._config||!this.hass)return B``;if(!this._data&&!1!==this._config.energy_date_selection)return B`<ha-card style="padding:2rem">${this.hass.localize("ui.panel.lovelace.cards.energy.loading")}<br>Make sure you have the Energy Integration setup and a Date Selector in this View or set<pre>energy_date_selection: false</pre>.</ha-card>`;const Ma=this._config.entities;this.style.setProperty("--clickable-cursor",this._config.clickable_entities?"pointer":"default");const Da=null,Pa=null,ja={entity:null===(e=Ma.grid)||void 0===e?void 0:e.entity,has:void 0!==(null===(t=null==Ma?void 0:Ma.grid)||void 0===t?void 0:t.entity),hasReturnToGrid:!!(null===(i=null===(o=Ma.grid)||void 0===o?void 0:o.entity)||void 0===i?void 0:i.production),state:{fromGrid:0,toGrid:Da,toBattery:Da,toHome:Da},powerOutage:{has:this.hasField(null===(a=Ma.grid)||void 0===a?void 0:a.power_outage,!0),isOutage:(Ma.grid&&(null===(r=Ma.grid.power_outage)||void 0===r?void 0:r.entity)&&(null===(n=this.hass.states[Ma.grid.power_outage.entity])||void 0===n?void 0:n.state))===(null!==(d=null===(s=null===(l=Ma.grid)||void 0===l?void 0:l.power_outage)||void 0===s?void 0:s.state_alert)&&void 0!==d?d:"on"),icon:(null===(u=null===(c=Ma.grid)||void 0===c?void 0:c.power_outage)||void 0===u?void 0:u.icon_alert)||"mdi:transmission-tower-off",name:null!==(_=null===(v=null===(h=Ma.grid)||void 0===h?void 0:h.power_outage)||void 0===v?void 0:v.label_alert)&&void 0!==_?_:B`Power<br>Outage`},icon:this.computeFieldIcon(Ma.grid,"mdi:transmission-tower"),name:this.computeFieldName(Ma.grid,this.hass.localize("ui.panel.lovelace.cards.energy.energy_distribution.grid")),mainEntity:Array.isArray(null===(m=null===(p=null==Ma?void 0:Ma.grid)||void 0===p?void 0:p.entity)||void 0===m?void 0:m.consumption)?null===(g=null===(y=null==Ma?void 0:Ma.grid)||void 0===y?void 0:y.entity)||void 0===g?void 0:g.consumption[0]:"string"==typeof(null===(b=null===(f=null==Ma?void 0:Ma.grid)||void 0===f?void 0:f.entity)||void 0===b?void 0:b.consumption)?null===(x=null===(w=null==Ma?void 0:Ma.grid)||void 0===w?void 0:w.entity)||void 0===x?void 0:x.consumption:Array.isArray(null===($=null===(k=null==Ma?void 0:Ma.grid)||void 0===k?void 0:k.entity)||void 0===$?void 0:$.production)?null===(S=null===(E=null==Ma?void 0:Ma.grid)||void 0===E?void 0:E.entity)||void 0===S?void 0:S.production[0]:"string"==typeof(null===(A=null===(C=null==Ma?void 0:Ma.grid)||void 0===C?void 0:C.entity)||void 0===A?void 0:A.production)?null===(M=null===(z=null==Ma?void 0:Ma.grid)||void 0===z?void 0:z.entity)||void 0===M?void 0:M.production:void 0,color:{fromGrid:null===(P=null===(D=Ma.grid)||void 0===D?void 0:D.color)||void 0===P?void 0:P.consumption,toGrid:null===(O=null===(j=Ma.grid)||void 0===j?void 0:j.color)||void 0===O?void 0:O.production,icon_type:null===(T=Ma.grid)||void 0===T?void 0:T.color_icon,circle_type:null===(N=Ma.grid)||void 0===N?void 0:N.color_circle},secondary:{entity:null===(I=null===(U=Ma.grid)||void 0===U?void 0:U.secondary_info)||void 0===I?void 0:I.entity,template:null===(F=null===(H=Ma.grid)||void 0===H?void 0:H.secondary_info)||void 0===F?void 0:F.template,has:this.hasField(null===(R=Ma.grid)||void 0===R?void 0:R.secondary_info,!0),state:Pa,icon:null===(W=null===(L=Ma.grid)||void 0===L?void 0:L.secondary_info)||void 0===W?void 0:W.icon,unit:null===(K=null===(V=Ma.grid)||void 0===V?void 0:V.secondary_info)||void 0===K?void 0:K.unit_of_measurement,unit_white_space:null===(Y=null===(Z=Ma.grid)||void 0===Z?void 0:Z.secondary_info)||void 0===Y?void 0:Y.unit_white_space,decimals:null===(J=null===(q=Ma.grid)||void 0===q?void 0:q.secondary_info)||void 0===J?void 0:J.decimals,energyDateSelection:(null===(X=null===(Q=Ma.grid)||void 0===Q?void 0:Q.secondary_info)||void 0===X?void 0:X.energy_date_selection)||!1,color:{type:null===(te=null===(ee=Ma.grid)||void 0===ee?void 0:ee.secondary_info)||void 0===te?void 0:te.color_value}}},Oa={entity:null===(oe=Ma.solar)||void 0===oe?void 0:oe.entity,mainEntity:Array.isArray(null===(ie=Ma.solar)||void 0===ie?void 0:ie.entity)?null===(ae=Ma.solar)||void 0===ae?void 0:ae.entity[0]:null===(re=Ma.solar)||void 0===re?void 0:re.entity,has:void 0!==(null===(ne=Ma.solar)||void 0===ne?void 0:ne.entity),state:{total:Da,toHome:Da,toGrid:Da,toBattery:Da},icon:this.computeFieldIcon(Ma.solar,"mdi:solar-power"),name:this.computeFieldName(Ma.solar,this.hass.localize("ui.panel.lovelace.cards.energy.energy_distribution.solar")),secondary:{entity:null===(se=null===(le=Ma.solar)||void 0===le?void 0:le.secondary_info)||void 0===se?void 0:se.entity,template:null===(ce=null===(de=Ma.solar)||void 0===de?void 0:de.secondary_info)||void 0===ce?void 0:ce.template,has:this.hasField(null===(ue=Ma.solar)||void 0===ue?void 0:ue.secondary_info,!0),state:Pa,icon:null===(ve=null===(he=Ma.solar)||void 0===he?void 0:he.secondary_info)||void 0===ve?void 0:ve.icon,unit:null===(pe=null===(_e=Ma.solar)||void 0===_e?void 0:_e.secondary_info)||void 0===pe?void 0:pe.unit_of_measurement,decimals:null===(ye=null===(me=Ma.solar)||void 0===me?void 0:me.secondary_info)||void 0===ye?void 0:ye.decimals,unit_white_space:null===(fe=null===(ge=Ma.solar)||void 0===ge?void 0:ge.secondary_info)||void 0===fe?void 0:fe.unit_white_space,energyDateSelection:(null===(we=null===(be=Ma.solar)||void 0===be?void 0:be.secondary_info)||void 0===we?void 0:we.energy_date_selection)||!1}},Ta={entity:null===(xe=Ma.battery)||void 0===xe?void 0:xe.entity,has:void 0!==(null===(ke=null==Ma?void 0:Ma.battery)||void 0===ke?void 0:ke.entity),mainEntity:"object"==typeof(null===($e=Ma.battery)||void 0===$e?void 0:$e.entity)?Ma.battery.entity.consumption:null===(Ee=Ma.battery)||void 0===Ee?void 0:Ee.entity,name:this.computeFieldName(Ma.battery,this.hass.localize("ui.panel.lovelace.cards.energy.energy_distribution.battery")),icon:this.computeFieldIcon(Ma.battery,"mdi:battery-high"),state_of_charge:{state:(null===(Ce=null===(Se=Ma.battery)||void 0===Se?void 0:Se.state_of_charge)||void 0===Ce?void 0:Ce.length)?this.getEntityState(null===(Ae=Ma.battery)||void 0===Ae?void 0:Ae.state_of_charge):null,unit:(null===(ze=null==Ma?void 0:Ma.battery)||void 0===ze?void 0:ze.state_of_charge_unit)||"%",unit_white_space:(null===(Me=null==Ma?void 0:Ma.battery)||void 0===Me?void 0:Me.state_of_charge_unit_white_space)||!0,decimals:(null===(De=null==Ma?void 0:Ma.battery)||void 0===De?void 0:De.state_of_charge_decimals)||0},state:{toBattery:0,fromBattery:0,toGrid:0,toHome:0},color:{fromBattery:null===(je=null===(Pe=Ma.battery)||void 0===Pe?void 0:Pe.color)||void 0===je?void 0:je.consumption,toBattery:null===(Te=null===(Oe=Ma.battery)||void 0===Oe?void 0:Oe.color)||void 0===Te?void 0:Te.production,icon_type:void 0,circle_type:null===(Ne=Ma.battery)||void 0===Ne?void 0:Ne.color_circle,state_of_charge_type:null===(Ue=Ma.battery)||void 0===Ue?void 0:Ue.color_state_of_charge_value}},Na={entity:null===(Be=Ma.home)||void 0===Be?void 0:Be.entity,mainEntity:Array.isArray(null===(Ge=Ma.home)||void 0===Ge?void 0:Ge.entity)?null===(Ie=Ma.home)||void 0===Ie?void 0:Ie.entity[0]:null===(He=Ma.home)||void 0===He?void 0:He.entity,has:void 0!==(null===(Fe=null==Ma?void 0:Ma.home)||void 0===Fe?void 0:Fe.entity),state:Da,icon:this.computeFieldIcon(null==Ma?void 0:Ma.home,"mdi:home"),name:this.computeFieldName(null==Ma?void 0:Ma.home,this.hass.localize("ui.panel.lovelace.cards.energy.energy_distribution.home")),color:{icon_type:null===(Re=Ma.home)||void 0===Re?void 0:Re.color_icon},secondary:{entity:null===(We=null===(Le=Ma.home)||void 0===Le?void 0:Le.secondary_info)||void 0===We?void 0:We.entity,template:null===(Ze=null===(Ve=Ma.home)||void 0===Ve?void 0:Ve.secondary_info)||void 0===Ze?void 0:Ze.template,has:this.hasField(null===(Ye=Ma.home)||void 0===Ye?void 0:Ye.secondary_info,!0),state:null,unit:null===(Je=null===(qe=Ma.home)||void 0===qe?void 0:qe.secondary_info)||void 0===Je?void 0:Je.unit_of_measurement,unit_white_space:null===(Xe=null===(Qe=Ma.home)||void 0===Qe?void 0:Qe.secondary_info)||void 0===Xe?void 0:Xe.unit_white_space,icon:null===(it=null===(ot=Ma.home)||void 0===ot?void 0:ot.secondary_info)||void 0===it?void 0:it.icon,decimals:null===(rt=null===(at=Ma.home)||void 0===at?void 0:at.secondary_info)||void 0===rt?void 0:rt.decimals,energyDateSelection:(null===(lt=null===(nt=Ma.home)||void 0===nt?void 0:nt.secondary_info)||void 0===lt?void 0:lt.energy_date_selection)||!1}},Ua=e=>{var t,o,i,a,r,n,l,s,d,c,u,h,v,_,p,m,y,g,f,b,w,x,k,$,E,S,C,A,z,M,D;return{entity:null===(t=Ma[e])||void 0===t?void 0:t.entity,mainEntity:Array.isArray(null===(o=Ma[e])||void 0===o?void 0:o.entity)?null===(i=Ma[e])||void 0===i?void 0:i.entity[0]:null===(a=Ma[e])||void 0===a?void 0:a.entity,has:this.hasField(Ma[e]),displayZero:null===(r=Ma[e])||void 0===r?void 0:r.display_zero,displayZeroTolerance:null===(n=Ma[e])||void 0===n?void 0:n.display_zero_tolerance,state:Da,icon:this.computeFieldIcon(Ma[e],"individual1"===e?"mdi:car-electric":"mdi:motorbike-electric"),name:this.computeFieldName(Ma[e],Ke("individual1"===e?"card.label.car":"card.label.motorbike")),color:null===(l=Ma[e])||void 0===l?void 0:l.color,unit:null===(s=Ma[e])||void 0===s?void 0:s.unit_of_measurement,unit_white_space:null===(d=Ma[e])||void 0===d?void 0:d.unit_white_space,decimals:null===(c=Ma[e])||void 0===c?void 0:c.decimals,invertAnimation:(null===(u=Ma[e])||void 0===u?void 0:u.inverted_animation)||!1,showDirection:(null===(h=Ma[e])||void 0===h?void 0:h.show_direction)||!1,secondary:{entity:null===(_=null===(v=Ma[e])||void 0===v?void 0:v.secondary_info)||void 0===_?void 0:_.entity,template:null===(m=null===(p=Ma[e])||void 0===p?void 0:p.secondary_info)||void 0===m?void 0:m.template,has:this.hasField(null===(y=Ma[e])||void 0===y?void 0:y.secondary_info,!0),state:Pa,icon:null===(f=null===(g=Ma[e])||void 0===g?void 0:g.secondary_info)||void 0===f?void 0:f.icon,unit:null===(w=null===(b=Ma[e])||void 0===b?void 0:b.secondary_info)||void 0===w?void 0:w.unit_of_measurement,unit_white_space:null===(k=null===(x=Ma[e])||void 0===x?void 0:x.secondary_info)||void 0===k?void 0:k.unit_white_space,displayZero:null===(E=null===($=Ma[e])||void 0===$?void 0:$.secondary_info)||void 0===E?void 0:E.display_zero,decimals:null===(C=null===(S=Ma[e])||void 0===S?void 0:S.secondary_info)||void 0===C?void 0:C.decimals,displayZeroTolerance:null===(z=null===(A=Ma[e])||void 0===A?void 0:A.secondary_info)||void 0===z?void 0:z.display_zero_tolerance,energyDateSelection:(null===(D=null===(M=Ma[e])||void 0===M?void 0:M.secondary_info)||void 0===D?void 0:D.energy_date_selection)||!1}}},Ba=Ua("individual1"),Ga=Ua("individual2"),Ia={entity:null===(st=Ma.fossil_fuel_percentage)||void 0===st?void 0:st.entity,mainEntity:Array.isArray(null===(dt=Ma.fossil_fuel_percentage)||void 0===dt?void 0:dt.entity)?null===(ct=Ma.fossil_fuel_percentage)||void 0===ct?void 0:ct.entity[0]:null===(ut=Ma.fossil_fuel_percentage)||void 0===ut?void 0:ut.entity,name:(null===(ht=Ma.fossil_fuel_percentage)||void 0===ht?void 0:ht.name)||(null===(vt=Ma.fossil_fuel_percentage)||void 0===vt?void 0:vt.use_metadata)&&(null===(_t=this.getEntityStateObj(Ma.fossil_fuel_percentage.entity))||void 0===_t?void 0:_t.attributes.friendly_name)||this.hass.localize("ui.panel.lovelace.cards.energy.energy_distribution.low_carbon"),icon:(null===(pt=Ma.fossil_fuel_percentage)||void 0===pt?void 0:pt.icon)||(null===(mt=Ma.fossil_fuel_percentage)||void 0===mt?void 0:mt.use_metadata)&&(null===(ft=null===(yt=this.getEntityStateObj(Ma.fossil_fuel_percentage.entity))||void 0===yt?void 0:yt.attributes)||void 0===ft?void 0:ft.icon)||"mdi:leaf",has:!1,hasPercentage:!1,state:{power:Da},color:null===(bt=Ma.fossil_fuel_percentage)||void 0===bt?void 0:bt.color,color_value:null===(wt=Ma.fossil_fuel_percentage)||void 0===wt?void 0:wt.color_value,secondary:{entity:null===(kt=null===(xt=Ma.fossil_fuel_percentage)||void 0===xt?void 0:xt.secondary_info)||void 0===kt?void 0:kt.entity,template:null===(Et=null===($t=Ma.fossil_fuel_percentage)||void 0===$t?void 0:$t.secondary_info)||void 0===Et?void 0:Et.template,has:this.hasField(null===(St=Ma.fossil_fuel_percentage)||void 0===St?void 0:St.secondary_info,!0),state:Pa,icon:null===(At=null===(Ct=Ma.fossil_fuel_percentage)||void 0===Ct?void 0:Ct.secondary_info)||void 0===At?void 0:At.icon,unit:null===(Mt=null===(zt=Ma.fossil_fuel_percentage)||void 0===zt?void 0:zt.secondary_info)||void 0===Mt?void 0:Mt.unit_of_measurement,unit_white_space:null===(jt=null===(Pt=Ma.fossil_fuel_percentage)||void 0===Pt?void 0:Pt.secondary_info)||void 0===jt?void 0:jt.unit_white_space,color_value:null===(Tt=null===(Ot=Ma.fossil_fuel_percentage)||void 0===Ot?void 0:Ot.secondary_info)||void 0===Tt?void 0:Tt.color_value,energyDateSelection:(null===(Ut=null===(Nt=Ma.fossil_fuel_percentage)||void 0===Nt?void 0:Nt.secondary_info)||void 0===Ut?void 0:Ut.energy_date_selection)||!1}};if(ja.powerOutage.isOutage&&(ja.state.fromGrid=0,ja.state.toGrid=0,ja.icon=ja.powerOutage.icon),void 0!==ja.color.fromGrid&&("object"==typeof ja.color.fromGrid&&(ja.color.fromGrid=this.convertColorListToHex(ja.color.fromGrid)),this.style.setProperty("--energy-grid-consumption-color",ja.color.fromGrid||"var(--energy-grid-consumption-color)")),ja.has&&("string"==typeof Ma.grid.entity?this.entityInverted("grid")?ja.state.fromGrid=Math.abs(Math.min(this.getEntityStateWatthours(null===(Bt=Ma.grid)||void 0===Bt?void 0:Bt.entity),0)):ja.state.fromGrid=Math.max(this.getEntityStateWatthours(null===(Gt=Ma.grid)||void 0===Gt?void 0:Gt.entity),0):ja.state.fromGrid=this.getEntityStateWatthours(Ma.grid.entity.consumption)),void 0!==(null===(It=Ma.grid)||void 0===It?void 0:It.display_zero_tolerance)&&(null===(Ht=Ma.grid)||void 0===Ht?void 0:Ht.display_zero_tolerance)<=ja.state.fromGrid&&(ja.state.fromGrid=0),void 0!==ja.color.toGrid&&("object"==typeof ja.color.toGrid&&(ja.color.toGrid=this.convertColorListToHex(ja.color.toGrid)),this.style.setProperty("--energy-grid-return-color",ja.color.toGrid||"#a280db")),ja.hasReturnToGrid&&(ja.state.toGrid=this.getEntityStateWatthours(null===(Ft=Ma.grid)||void 0===Ft?void 0:Ft.entity.production)),void 0!==(null===(Rt=Ma.grid)||void 0===Rt?void 0:Rt.display_zero_tolerance)&&(null===(Lt=Ma.grid)||void 0===Lt?void 0:Lt.display_zero_tolerance)<=(null!==(Wt=ja.state.toGrid)&&void 0!==Wt?Wt:0)&&(ja.state.toGrid=0),ja.icon=ja.powerOutage.isOutage?(null===(Kt=null===(Vt=null==Ma?void 0:Ma.grid)||void 0===Vt?void 0:Vt.power_outage)||void 0===Kt?void 0:Kt.icon_alert)||"mdi:transmission-tower-off":this.computeFieldIcon(Ma.grid,"mdi:transmission-tower"),this.style.setProperty("--icon-grid-color","consumption"===ja.color.icon_type?"var(--energy-grid-consumption-color)":"production"===ja.color.icon_type?"var(--energy-grid-return-color)":!0===ja.color.icon_type?ja.state.fromGrid>=(null!==(Zt=ja.state.toGrid)&&void 0!==Zt?Zt:0)?"var(--energy-grid-consumption-color)":"var(--energy-grid-return-color)":"var(--primary-text-color)"),this.style.setProperty("--secondary-text-grid-color","consumption"===ja.secondary.color.type?"var(--energy-grid-consumption-color)":"production"===ja.secondary.color.type?"var(--energy-grid-return-color)":!0===ja.secondary.color.type?ja.state.fromGrid>=(null!==(Yt=ja.state.toGrid)&&void 0!==Yt?Yt:0)?"var(--energy-grid-consumption-color)":"var(--energy-grid-return-color)":"var(--primary-text-color)"),this.style.setProperty("--circle-grid-color","consumption"===ja.color.circle_type?"var(--energy-grid-consumption-color)":"production"===ja.color.circle_type?"var(--energy-grid-return-color)":!0===ja.color.circle_type?ja.state.fromGrid>=(null!==(qt=ja.state.toGrid)&&void 0!==qt?qt:0)?"var(--energy-grid-consumption-color)":"var(--energy-grid-return-color)":"var(--energy-grid-consumption-color)"),Ba.state=Ba.has?this.getEntityStateWatthours(null===(Jt=Ma.individual1)||void 0===Jt?void 0:Jt.entity):0,Ga.state=Ga.has?this.getEntityStateWatthours(null===(Qt=Ma.individual2)||void 0===Qt?void 0:Qt.entity):0,void 0!==Ba.color&&("object"==typeof Ba.color&&(Ba.color=this.convertColorListToHex(Ba.color)),this.style.setProperty("--individualone-color",Ba.color)),void 0!==Ga.color&&("object"==typeof Ga.color&&(Ga.color=this.convertColorListToHex(Ga.color)),this.style.setProperty("--individualtwo-color",Ga.color)),this.style.setProperty("--icon-individualone-color",(null===(Xt=Ma.individual1)||void 0===Xt?void 0:Xt.color_icon)?"var(--individualone-color)":"var(--primary-text-color)"),this.style.setProperty("--icon-individualtwo-color",(null===(eo=Ma.individual2)||void 0===eo?void 0:eo.color_icon)?"var(--individualtwo-color)":"var(--primary-text-color)"),Ba.secondary.state=this.getSecondaryState(Ba.secondary,"individual1Secondary"),Ga.secondary.state=this.getSecondaryState(Ga.secondary,"individual2Secondary"),Oa.secondary.state=this.getSecondaryState(Oa.secondary,"solarSecondary"),Na.secondary.state=this.getSecondaryState(Na.secondary,"homeSecondary"),Ia.secondary.state=this.getSecondaryState(Ia.secondary,"nonFossilSecondary"),ja.secondary.state=this.getSecondaryState(ja.secondary,"gridSecondary"),void 0!==(null===(to=Ma.solar)||void 0===to?void 0:to.color)){let e=null===(oo=Ma.solar)||void 0===oo?void 0:oo.color;"object"==typeof e&&(e=this.convertColorListToHex(e)),this.style.setProperty("--energy-solar-color",e||"#ff9800")}this.style.setProperty("--icon-solar-color",(null===(io=Ma.solar)||void 0===io?void 0:io.color_icon)?"var(--energy-solar-color)":"var(--primary-text-color)"),Oa.has&&(this.entityInverted("solar")?Oa.state.total=Math.abs(Math.min(this.getEntityStateWatthours(null===(ao=Ma.solar)||void 0===ao?void 0:ao.entity),0)):Oa.state.total=Math.max(this.getEntityStateWatthours(null===(ro=Ma.solar)||void 0===ro?void 0:ro.entity),0),(null===(no=Ma.solar)||void 0===no?void 0:no.display_zero_tolerance)&&Ma.solar.display_zero_tolerance>=Oa.state.total&&(Oa.state.total=0)),Ta.has&&(Ta.state.toBattery=this.getEntityStateWatthours(null===(so=null===(lo=Ma.battery)||void 0===lo?void 0:lo.entity)||void 0===so?void 0:so.production),Ta.state.fromBattery=this.getEntityStateWatthours(null===(uo=null===(co=Ma.battery)||void 0===co?void 0:co.entity)||void 0===uo?void 0:uo.consumption)),(null===(ho=null==Ma?void 0:Ma.battery)||void 0===ho?void 0:ho.display_zero_tolerance)&&(Ma.battery.display_zero_tolerance>=Ta.state.toBattery&&(Ta.state.toBattery=0),Ma.battery.display_zero_tolerance>=Ta.state.fromBattery&&(Ta.state.fromBattery=0)),Oa.has&&(Oa.state.toHome=(null!==(vo=Oa.state.total)&&void 0!==vo?vo:0)-(null!==(_o=ja.state.toGrid)&&void 0!==_o?_o:0)-(null!==(po=Ta.state.toBattery)&&void 0!==po?po:0)),null!==Oa.state.toHome&&Oa.state.toHome<0&&(Ta.has&&(ja.state.toBattery=Math.abs(Oa.state.toHome),ja.state.toBattery>ja.state.fromGrid&&(Ta.state.toGrid=Math.min(ja.state.toBattery-ja.state.fromGrid,0),ja.state.toBattery=ja.state.fromGrid)),Oa.state.toHome=0),Oa.has&&Ta.has?(Ta.state.toGrid||(Ta.state.toGrid=Math.max(0,(ja.state.toGrid||0)-(Oa.state.total||0)-(Ta.state.toBattery||0)-(ja.state.toBattery||0))),Oa.state.toBattery=Ta.state.toBattery-(ja.state.toBattery||0)):!Oa.has&&Ta.has&&(Ta.state.toGrid=null!==(mo=ja.state.toGrid)&&void 0!==mo?mo:0),Oa.has&&ja.state.toGrid&&(Oa.state.toGrid=ja.state.toGrid-(null!==(yo=Ta.state.toGrid)&&void 0!==yo?yo:0)),Ta.has&&(Ta.state.toHome=(null!==(go=Ta.state.fromBattery)&&void 0!==go?go:0)-(null!==(fo=Ta.state.toGrid)&&void 0!==fo?fo:0)),void 0!==Ta.color.fromBattery&&("object"==typeof Ta.color.fromBattery&&(Ta.color.fromBattery=this.convertColorListToHex(Ta.color.fromBattery)),this.style.setProperty("--energy-battery-out-color",Ta.color.fromBattery||"#4db6ac")),void 0!==Ta.color.toBattery&&("object"==typeof Ta.color.toBattery&&(Ta.color.toBattery=this.convertColorListToHex(Ta.color.toBattery)),this.style.setProperty("--energy-battery-in-color",Ta.color.toBattery||"#a280db")),this.style.setProperty("--icon-battery-color","var(--primary-text-color)"),this.style.setProperty("--text-battery-state-of-charge-color","consumption"===Ta.color.state_of_charge_type?"var(--energy-battery-in-color)":"production"===Ta.color.state_of_charge_type?"var(--energy-battery-out-color)":!0===Ta.color.state_of_charge_type?Ta.state.fromBattery>=Ta.state.toBattery?"var(--energy-battery-out-color)":"var(--energy-battery-in-color)":"var(--primary-text-color)"),this.style.setProperty("--circle-battery-color","consumption"===Ta.color.circle_type?"var(--energy-battery-in-color)":"production"===Ta.color.circle_type||!0===Ta.color.circle_type&&Ta.state.fromBattery>=Ta.state.toBattery?"var(--energy-battery-out-color)":"var(--energy-battery-in-color)");const Ha=tt(Ba.state,0)+tt(Ga.state,0),Fa=Math.max(ja.state.fromGrid+(null!==(bo=Oa.state.toHome)&&void 0!==bo?bo:0)+(null!==(wo=Ta.state.toHome)&&void 0!==wo?wo:0),0);let Ra=0;Ta.state.toHome&&(Ra=Dt*(Ta.state.toHome/Fa));let La,Wa,Va,Ka=0;Oa.has&&(Ka=Dt*(Oa.state.toHome/Fa));const Za=ja.state.fromGrid+(null!==(xo=Oa.state.toHome)&&void 0!==xo?xo:0)+(null!==(ko=Oa.state.toGrid)&&void 0!==ko?ko:0)+(null!==($o=Oa.state.toBattery)&&void 0!==$o?$o:0)+(null!==(Eo=Ta.state.toHome)&&void 0!==Eo?Eo:0)+(null!==(So=ja.state.toBattery)&&void 0!==So?So:0)+(null!==(Co=Ta.state.toGrid)&&void 0!==Co?Co:0),Ya=(null===(Ao=null==Ma?void 0:Ma.battery)||void 0===Ao?void 0:Ao.state_of_charge)?this.getEntityState(null===(zo=Ma.battery)||void 0===zo?void 0:zo.state_of_charge,!0):null;let qa="mdi:battery-high";null===Ya?qa="mdi:battery-high":Ya<=72&&Ya>44?qa="mdi:battery-medium":Ya<=44&&Ya>16?qa="mdi:battery-low":Ya<=16&&(qa="mdi:battery-outline"),void 0!==(null===(Mo=Ma.battery)||void 0===Mo?void 0:Mo.icon)&&(qa=null===(Do=Ma.battery)||void 0===Do?void 0:Do.icon);const Ja={batteryGrid:this.circleRate(null!==(jo=null!==(Po=ja.state.toBattery)&&void 0!==Po?Po:Ta.state.toGrid)&&void 0!==jo?jo:0,Za),batteryToHome:this.circleRate(null!==(Oo=Ta.state.toHome)&&void 0!==Oo?Oo:0,Za),gridToHome:this.circleRate(ja.state.fromGrid,Za),solarToBattery:this.circleRate(null!==(To=Oa.state.toBattery)&&void 0!==To?To:0,Za),solarToGrid:this.circleRate(null!==(No=Oa.state.toGrid)&&void 0!==No?No:0,Za),solarToHome:this.circleRate(null!==(Uo=Oa.state.toHome)&&void 0!==Uo?Uo:0,Za),individual1:this.circleRate(null!==(Bo=Ba.state)&&void 0!==Bo?Bo:0,Ha),individual2:this.circleRate(null!==(Go=Ga.state)&&void 0!==Go?Go:0,Ha),nonFossil:this.circleRate(0,Za)};["batteryGrid","batteryToHome","gridToHome","solar.state.toBattery","solar.state.toGrid","solarToHome"].forEach((e=>{const t=this[`${e}Flow`];t&&this.previousDur[e]&&this.previousDur[e]!==Ja[e]&&(t.pauseAnimations(),t.setCurrentTime(t.getCurrentTime()*(Ja[e]/this.previousDur[e])),t.unpauseAnimations()),this.previousDur[e]=Ja[e]}));let Qa=null===(Io=Ma.fossil_fuel_percentage)||void 0===Io?void 0:Io.color;void 0!==Qa&&("object"==typeof Qa&&(Qa=this.convertColorListToHex(Qa)),this.style.setProperty("--non-fossil-color",Qa||"var(--energy-non-fossil-color)")),this.style.setProperty("--icon-non-fossil-color",(null===(Ho=Ma.fossil_fuel_percentage)||void 0===Ho?void 0:Ho.color_icon)?"var(--non-fossil-color)":"var(--primary-text-color)");const Xa=null===(Fo=Ma.home)||void 0===Fo?void 0:Fo.color_icon,er={battery:{value:Ra,color:"var(--energy-battery-out-color)"},solar:{value:Ka,color:"var(--energy-solar-color)"},grid:{value:La,color:"var(--energy-grid-consumption-color)"},gridNonFossil:{value:Va,color:"var(--energy-non-fossil-color)"}},tr=Object.keys(er).reduce(((e,t)=>er[e].value>er[t].value?e:t));let or="var(--primary-text-color)";"solar"===Xa?or="var(--energy-solar-color)":"battery"===Xa?or="var(--energy-battery-out-color)":"grid"===Xa?or="var(--energy-grid-consumption-color)":!0===Xa&&(or=er[tr].color),this.style.setProperty("--icon-home-color",or);const ir=null===(Ro=Ma.home)||void 0===Ro?void 0:Ro.color_value;let ar="var(--primary-text-color)";"solar"===ir?ar="var(--energy-solar-color)":"battery"===ir?ar="var(--energy-battery-out-color)":"grid"===ir?ar="var(--energy-grid-consumption-color)":!0===ir&&(ar=er[tr].color);const rr=(null===(Lo=Ma.solar)||void 0===Lo?void 0:Lo.icon)||(null===(Wo=Ma.solar)||void 0===Wo?void 0:Wo.use_metadata)&&(null===(Ko=null===(Vo=this.getEntityStateObj(Oa.mainEntity))||void 0===Vo?void 0:Vo.attributes)||void 0===Ko?void 0:Ko.icon)||"mdi:solar-power",nr=(null===(Zo=Ma.solar)||void 0===Zo?void 0:Zo.name)||(null===(Yo=Ma.solar)||void 0===Yo?void 0:Yo.use_metadata)&&(null===(qo=this.getEntityStateObj(Oa.mainEntity))||void 0===qo?void 0:qo.attributes.friendly_name)||this.hass.localize("ui.panel.lovelace.cards.energy.energy_distribution.solar"),lr=(null===(Jo=Ma.home)||void 0===Jo?void 0:Jo.icon)||(null===(Qo=Ma.home)||void 0===Qo?void 0:Qo.use_metadata)&&(null===(ei=null===(Xo=this.getEntityStateObj(Na.mainEntity))||void 0===Xo?void 0:Xo.attributes)||void 0===ei?void 0:ei.icon)||"mdi:home",sr=(null===(ti=Ma.home)||void 0===ti?void 0:ti.name)||(null===(oi=Ma.home)||void 0===oi?void 0:oi.use_metadata)&&(null===(ii=this.getEntityStateObj(Na.mainEntity))||void 0===ii?void 0:ii.attributes.friendly_name)||this.hass.localize("ui.panel.lovelace.cards.energy.energy_distribution.home"),dr=(null===(ai=Ma.fossil_fuel_percentage)||void 0===ai?void 0:ai.icon)||(null===(ri=Ma.fossil_fuel_percentage)||void 0===ri?void 0:ri.use_metadata)&&(null===(li=null===(ni=this.getEntityStateObj(Ma.fossil_fuel_percentage.entity))||void 0===ni?void 0:ni.attributes)||void 0===li?void 0:li.icon)||"mdi:leaf",cr=(null===(si=Ma.fossil_fuel_percentage)||void 0===si?void 0:si.name)||(null===(di=Ma.fossil_fuel_percentage)||void 0===di?void 0:di.use_metadata)&&(null===(ci=this.getEntityStateObj(Ma.fossil_fuel_percentage.entity))||void 0===ci?void 0:ci.attributes.friendly_name)||this.hass.localize("ui.panel.lovelace.cards.energy.energy_distribution.low_carbon"),ur=this.displayValue(Ba.state,null===(ui=Ma.individual1)||void 0===ui?void 0:ui.unit_of_measurement,void 0,null===(hi=Ma.individual1)||void 0===hi?void 0:hi.decimals),hr=this.displayValue(Ga.state,null===(vi=Ma.individual2)||void 0===vi?void 0:vi.unit_of_measurement,void 0,null===(_i=Ma.individual2)||void 0===_i?void 0:_i.decimals);this.style.setProperty("--text-home-color",ar),this.style.setProperty("--text-solar-color",(null===(pi=Ma.solar)||void 0===pi?void 0:pi.color_value)?"var(--energy-solar-color)":"var(--primary-text-color)"),this.style.setProperty("--text-non-fossil-color",(null===(mi=Ma.fossil_fuel_percentage)||void 0===mi?void 0:mi.color_value)?"var(--non-fossil-color)":"var(--primary-text-color)"),this.style.setProperty("--secondary-text-non-fossil-color",(null===(gi=null===(yi=Ma.fossil_fuel_percentage)||void 0===yi?void 0:yi.secondary_info)||void 0===gi?void 0:gi.color_value)?"var(--non-fossil-color)":"var(--primary-text-color)"),this.style.setProperty("--text-individualone-color",(null===(fi=Ma.individual1)||void 0===fi?void 0:fi.color_value)?"var(--individualone-color)":"var(--primary-text-color)"),this.style.setProperty("--text-individualtwo-color",(null===(bi=Ma.individual2)||void 0===bi?void 0:bi.color_value)?"var(--individualtwo-color)":"var(--primary-text-color)"),this.style.setProperty("--secondary-text-individualone-color",(null===(xi=null===(wi=Ma.individual1)||void 0===wi?void 0:wi.secondary_info)||void 0===xi?void 0:xi.color_value)?"var(--individualone-color)":"var(--primary-text-color)"),this.style.setProperty("--secondary-text-individualtwo-color",(null===($i=null===(ki=Ma.individual2)||void 0===ki?void 0:ki.secondary_info)||void 0===$i?void 0:$i.color_value)?"var(--individualtwo-color)":"var(--primary-text-color)"),this.style.setProperty("--secondary-text-solar-color",(null===(Si=null===(Ei=Ma.solar)||void 0===Ei?void 0:Ei.secondary_info)||void 0===Si?void 0:Si.color_value)?"var(--energy-solar-color)":"var(--primary-text-color)"),this.style.setProperty("--secondary-text-home-color",(null===(Ai=null===(Ci=Ma.home)||void 0===Ci?void 0:Ci.secondary_info)||void 0===Ai?void 0:Ai.color_value)?"var(--text-home-color)":"var(--primary-text-color)");const vr=(null===(zi=Ma.home)||void 0===zi?void 0:zi.override_state)&&Ma.home.entity?(null===(Mi=Ma.home)||void 0===Mi?void 0:Mi.subtract_individual)?this.displayValue(this.getEntityStateWatthours(Ma.home.entity)-Ha):this.displayValue(this.getEntityStateWatthours(Ma.home.entity)):(null===(Di=Ma.home)||void 0===Di?void 0:Di.subtract_individual)?this.displayValue(Fa-Ha||0):this.displayValue(Fa);let _r;if(this._data&&this._data.co2SignalEntity&&this._data.fossilEnergyConsumption){const e=1e3*Object.values(this._data.fossilEnergyConsumption).reduce(((e,t)=>e+t),0);null!==e&&(Wa=ja.state.fromGrid-e);const t=e*(ja.state.fromGrid/ja.state.fromGrid);La=Dt*(t/Fa),Va=Dt-(Ka||0)-(Ra||0)-La,_r=(Wa||0)/ja.state.fromGrid*100}const pr=null!==Wa&&Wa&&Wa>(1e3*(null!==(ji=null===(Pi=Ma.fossil_fuel_percentage)||void 0===Pi?void 0:Pi.display_zero_tolerance)&&void 0!==ji?ji:0)||0),mr=!0===(null===(Oi=Ma.fossil_fuel_percentage)||void 0===Oi?void 0:Oi.show);!1===this._config.energy_date_selection&&(_r=100-this.getEntityState(null===(Ti=Ma.fossil_fuel_percentage)||void 0===Ti?void 0:Ti.entity,!0),Wa=_r*ja.state.fromGrid/100);const yr=this._width>420;Oa.has&&(Ta.has?(this.style.setProperty("--lines-svg-not-flat-line-height",yr?"106%":"102%"),this.style.setProperty("--lines-svg-not-flat-line-top",yr?"-3%":"-1%"),this.style.setProperty("--lines-svg-flat-width","calc(100% - 160px)")):(this.style.setProperty("--lines-svg-not-flat-line-height",yr?"104%":"102%"),this.style.setProperty("--lines-svg-not-flat-line-top",yr?"-2%":"-1%"),this.style.setProperty("--lines-svg-flat-width",yr?"calc(100% - 154px)":"calc(100% - 157px)"),this.style.setProperty("--lines-svg-not-flat-width",yr?"calc(103% - 172px)":"calc(103% - 169px)")));const gr=({className:e,template:t,value:o,entityId:i,icon:a})=>{var r,n;return o||t?B`<span class="secondary-info ${e}" @click="${e=>{this.openDetails(e,i)}}" @keyDown="${e=>{"Enter"===e.key&&this.openDetails(e,i)}}">${(null===(n=null===(r=Ma.solar)||void 0===r?void 0:r.secondary_info)||void 0===n?void 0:n.icon)?B`<ha-icon class="secondary-info small" .icon="${a}"></ha-icon>`:""} ${null!=t?t:o}</span>`:""},fr=(e,t)=>{var o;return B`${e.secondary.has||e.secondary.template?B`${gr({className:t,entityId:e.secondary.entity,icon:e.secondary.icon,value:this.displayValue(e.secondary.state,e.secondary.unit,e.secondary.unit_white_space,null===(o=null==e?void 0:e.secondary)||void 0===o?void 0:o.decimals)})}`:""}`},br=(e,t)=>{var o,i;const a=e.secondary.has?this.displayValue(e.secondary.state,e.secondary.unit,e.secondary.unit_white_space):void 0,r=!1!==e.secondary.displayZero||!et(e.secondary.state)||(null!==(o=Number(e.secondary.state))&&void 0!==o?o:0)>(null!==(i=e.secondary.displayZeroTolerance)&&void 0!==i?i:0);return B`${e.secondary.has&&r?B`${gr({className:t,entityId:e.secondary.entity,icon:e.secondary.icon,value:a})}`:""}`};return B`<ha-card .header="${this._config.title}"><div class="card-content" id="energy-flow-card-plus">${Oa.has||Ga.has||Ba.has||mr?B`<div class="row">${!mr||!pr&&!1===(null===(Ni=Ma.fossil_fuel_percentage)||void 0===Ni?void 0:Ni.display_zero)?B`<div class="spacer"></div>`:B`<div class="circle-container low-carbon"><span class="label">${cr}</span><div class="circle" @click="${e=>{var t;this.openDetails(e,null===(t=Ma.fossil_fuel_percentage)||void 0===t?void 0:t.entity)}}" @keyDown="${e=>{var t;"Enter"===e.key&&this.openDetails(e,null===(t=Ma.fossil_fuel_percentage)||void 0===t?void 0:t.entity)}}">${fr(Ia,"nonFossilFuel")}<ha-icon .icon="${dr}" class="low-carbon" style="${Ia.secondary.has?"padding-top: 2px;":"padding-top: 0px;"}${!1!==(null===(Ui=Ma.fossil_fuel_percentage)||void 0===Ui?void 0:Ui.display_zero_state)||0>((null===(Bi=Ma.fossil_fuel_percentage)||void 0===Bi?void 0:Bi.display_zero_tolerance)||0)?"padding-bottom: 2px;":"padding-bottom: 0px;"}"></ha-icon>${!1!==(null===(Gi=Ma.fossil_fuel_percentage)||void 0===Gi?void 0:Gi.display_zero_state)||!1!==pr?B`<span class="low-carbon">${this.displayValue("percentage"===(null===(Ii=Ma.fossil_fuel_percentage)||void 0===Ii?void 0:Ii.state_type)?_r||0:Wa||0,"percentage"===(null===(Hi=Ma.fossil_fuel_percentage)||void 0===Hi?void 0:Hi.state_type)?"%":void 0,null===(Fi=Ma.fossil_fuel_percentage)||void 0===Fi?void 0:Fi.unit_white_space,null===(Ri=Ma.fossil_fuel_percentage)||void 0===Ri?void 0:Ri.decimals)}</span>`:""}</div>${this.showLine(0)?B`<svg width="80" height="30"><path d="M40 -10 v40" class="low-carbon" id="low-carbon"/>${pr?G`<circle r="2.4" class="low-carbon" vector-effect="non-scaling-stroke"><animateMotion dur="${this.additionalCircleRate(null===(Li=Ma.fossil_fuel_percentage)||void 0===Li?void 0:Li.calculate_flow_rate,Ja.nonFossil)||0}s" repeatCount="indefinite" calcMode="linear"><mpath xlink:href="#low-carbon"></animateMotion></circle>`:""}</svg>`:""}</div>`} ${Oa.has?B`<div class="circle-container solar"><span class="label">${nr}</span><div class="circle" @click="${e=>{this.openDetails(e,Oa.mainEntity)}}" @keyDown="${e=>{"Enter"===e.key&&this.openDetails(e,Oa.mainEntity)}}">${fr(Oa,"solar")}<ha-icon id="solar-icon" .icon="${rr}" style="${Oa.secondary.has?"padding-top: 2px;":"padding-top: 0px;"}${!1!==(null===(Wi=Ma.solar)||void 0===Wi?void 0:Wi.display_zero_state)||(Oa.state.total||0)>0?"padding-bottom: 2px;":"padding-bottom: 0px;"}"></ha-icon>${!1!==(null===(Vi=Ma.solar)||void 0===Vi?void 0:Vi.display_zero_state)||(Oa.state.total||0)>0?B`<span class="solar">${this.displayValue(Oa.state.total)}</span>`:""}</div></div>`:Ga.has||Ba.has?B`<div class="spacer"></div>`:""} ${Ga.has?B`<div class="circle-container individual2"><span class="label">${Ga.name}</span><div class="circle" @click="${e=>{this.openDetails(e,Ga.mainEntity)}}" @keyDown="${e=>{"Enter"===e.key&&this.openDetails(e,Ga.mainEntity)}}">${br(Ga,"individual2")}<ha-icon id="individual2-icon" .icon="${Ga.icon}" style="${Ga.secondary.has?"padding-top: 2px;":"padding-top: 0px;"}${!1!==(null===(Ki=Ma.individual2)||void 0===Ki?void 0:Ki.display_zero_state)||(Ga.state||0)>0?"padding-bottom: 2px;":"padding-bottom: 0px;"}"></ha-icon>${!1!==(null===(Zi=Ma.individual2)||void 0===Zi?void 0:Zi.display_zero_state)||(Ga.state||0)>0?B`<span class="individual2">${hr}</span>`:""}</div>${this.showLine(Ga.state||0)?B`<svg width="80" height="30"><path d="M40 -10 v50" id="individual2"/>${Ga.state?G`<circle r="2.4" class="individual2" vector-effect="non-scaling-stroke"><animateMotion dur="${this.additionalCircleRate(null===(Yi=Ma.individual2)||void 0===Yi?void 0:Yi.calculate_flow_rate,Ja.individual2)}s" repeatCount="indefinite" calcMode="linear" keyPoints="${(null===(qi=Ma.individual2)||void 0===qi?void 0:qi.inverted_animation)?"0;1":"1;0"}" keyTimes="0;1"><mpath xlink:href="#individual2"></animateMotion></circle>`:""}</svg>`:""}</div>`:Ba.has?B`<div class="circle-container individual1"><span class="label">${Ba.name}</span><div class="circle" @click="${e=>{e.stopPropagation(),this.openDetails(e,Ba.mainEntity)}}" @keyDown="${e=>{"Enter"===e.key&&this.openDetails(e,Ba.mainEntity)}}">${br(Ba,"individual1")}<ha-icon id="individual1-icon" .icon="${Ba.icon}" style="${Ba.secondary.has?"padding-top: 2px;":"padding-top: 0px;"}${!1!==(null===(Ji=Ma.individual1)||void 0===Ji?void 0:Ji.display_zero_state)||(Ba.state||0)>0?"padding-bottom: 2px;":"padding-bottom: 0px;"}"></ha-icon>${!1!==(null===(Qi=Ma.individual1)||void 0===Qi?void 0:Qi.display_zero_state)||(Ba.state||0)>0?B`<span class="individual1">${ur}</span>`:""}</div>${this.showLine(Ba.state||0)?B`<svg width="80" height="30"><path d="M40 -10 v40" id="individual1"/>${Ba.state?G`<circle r="2.4" class="individual1" vector-effect="non-scaling-stroke"><animateMotion dur="${this.additionalCircleRate(null===(Xi=Ma.individual1)||void 0===Xi?void 0:Xi.calculate_flow_rate,Ja.individual1)}s" repeatCount="indefinite" calcMode="linear" keyPoints="${(null===(ea=Ma.individual1)||void 0===ea?void 0:ea.inverted_animation)?"0;1":"1;0"}" keyTimes="0;1"><mpath xlink:href="#individual1"></animateMotion></circle>`:""}</svg>`:B``}</div>`:B`<div class="spacer"></div>`}</div>`:B``}<div class="row">${ja.has?B`<div class="circle-container grid"><div class="circle" @click="${e=>{this.openDetails(e,ja.mainEntity)}}" @keyDown="${e=>{"Enter"===e.key&&this.openDetails(e,ja.mainEntity)}}">${fr(ja,"grid")}<ha-icon .icon="${ja.icon}"></ha-icon>${("two_way"===(null===(ta=Ma.grid)||void 0===ta?void 0:ta.display_state)||void 0===(null===(oa=Ma.grid)||void 0===oa?void 0:oa.display_state)||"one_way"===(null===(ia=Ma.grid)||void 0===ia?void 0:ia.display_state)&&(null!==(aa=ja.state.toGrid)&&void 0!==aa?aa:0)>0||"one_way_no_zero"===(null===(ra=Ma.grid)||void 0===ra?void 0:ra.display_state)&&(null===ja.state.fromGrid||0===ja.state.fromGrid)&&0!==ja.state.toGrid)&&null!==ja.state.toGrid&&!ja.powerOutage.isOutage?B`<span class="return" @click="${e=>{var t,o,i;const a=Array.isArray(Ma.grid.entity.production)?null===(o=null===(t=null==Ma?void 0:Ma.grid)||void 0===t?void 0:t.entity)||void 0===o?void 0:o.production[0]:null===(i=null==Ma?void 0:Ma.grid)||void 0===i?void 0:i.entity.production;this.openDetails(e,a)}}" @keyDown="${e=>{var t,o,i;if("Enter"===e.key){const a=Array.isArray(Ma.grid.entity.production)?null===(o=null===(t=null==Ma?void 0:Ma.grid)||void 0===t?void 0:t.entity)||void 0===o?void 0:o.production[0]:null===(i=null==Ma?void 0:Ma.grid)||void 0===i?void 0:i.entity.production;this.openDetails(e,a)}}}"><ha-icon class="small" .icon="${"mdi:arrow-left"}"></ha-icon>${this.displayValue(ja.state.toGrid)}</span>`:null} ${("two_way"===(null===(na=Ma.grid)||void 0===na?void 0:na.display_state)||void 0===(null===(la=Ma.grid)||void 0===la?void 0:la.display_state)||"one_way"===(null===(sa=Ma.grid)||void 0===sa?void 0:sa.display_state)&&ja.state.fromGrid>0||"one_way_no_zero"===(null===(da=Ma.grid)||void 0===da?void 0:da.display_state)&&(null===ja.state.toGrid||0===ja.state.toGrid))&&null!==ja.state.fromGrid&&!ja.powerOutage.isOutage?B`<span class="consumption"><ha-icon class="small" .icon="${"mdi:arrow-right"}"></ha-icon>${this.displayValue(ja.state.fromGrid)}</span>`:""} ${ja.powerOutage.isOutage?B`<span class="grid power-outage">${(null===(ua=null===(ca=Ma.grid)||void 0===ca?void 0:ca.power_outage)||void 0===ua?void 0:ua.label_alert)||B`Power<br>Outage`}</span>`:""}</div><span class="label">${ja.name}</span></div>`:B`<div class="spacer"></div>`}<div class="circle-container home"><div class="circle" id="home-circle" @click="${e=>{this.openDetails(e,Na.mainEntity)}}" @keyDown="${e=>{"Enter"===e.key&&this.openDetails(e,Na.mainEntity)}}">${fr(Na,"home")}<ha-icon .icon="${lr}"></ha-icon>${vr} <svg class="home-circle-sections">${void 0!==Ka?G`<circle class="solar" cx="40" cy="40" r="38" stroke-dasharray="${Ka} ${Dt-Ka}" shape-rendering="geometricPrecision" stroke-dashoffset="-${Dt-Ka}">`:""} ${Ra?G`<circle class="battery" cx="40" cy="40" r="38" stroke-dasharray="${Ra} ${Dt-Ra}" stroke-dashoffset="-${Dt-Ra-(Ka||0)}" shape-rendering="geometricPrecision">`:""} ${void 0!==Va?G`<circle class="low-carbon" cx="40" cy="40" r="38" stroke-dasharray="${Va} ${Dt-Va}" stroke-dashoffset="-${Dt-Va-(Ra||0)-(Ka||0)}" shape-rendering="geometricPrecision">`:""}<circle class="grid" cx="40" cy="40" r="38" stroke-dasharray="${null!=La?La:Dt-Ka-(Ra||0)} ${void 0!==La?Dt-La:Ka+(Ra||0)}" stroke-dashoffset="0" shape-rendering="geometricPrecision"/></svg></div>${this.showLine(Ba.state||0)&&Ga.has?"":B`<span class="label">${sr}</span>`}</div></div>${Ta.has||Ba.has&&Ga.has?B`<div class="row"><div class="spacer"></div>${Ta.has?B`<div class="circle-container battery"><div class="circle" @click="${e=>{var t,o,i,a,r;const n=(null===(t=Ma.battery)||void 0===t?void 0:t.state_of_charge)?null===(o=Ma.battery)||void 0===o?void 0:o.state_of_charge:"string"==typeof(null===(i=Ma.battery)||void 0===i?void 0:i.entity)?null===(a=Ma.battery)||void 0===a?void 0:a.entity:null===(r=Ma.battery)||void 0===r?void 0:r.entity.production;e.stopPropagation(),this.openDetails(e,n)}}" @keyDown="${e=>{var t,o;if("Enter"===e.key){const i=(null===(t=Ma.battery)||void 0===t?void 0:t.state_of_charge)?null===(o=Ma.battery)||void 0===o?void 0:o.state_of_charge:"string"==typeof Ma.battery.entity?Ma.battery.entity:Ma.battery.entity.production;e.stopPropagation(),this.openDetails(e,i)}}}">${null!==Ya?B`<span @click="${e=>{var t;e.stopPropagation(),this.openDetails(e,null===(t=Ma.battery)||void 0===t?void 0:t.state_of_charge)}}" @keyDown="${e=>{var t;"Enter"===e.key&&(e.stopPropagation(),this.openDetails(e,null===(t=Ma.battery)||void 0===t?void 0:t.state_of_charge))}}" id="battery-state-of-charge-text">${this.displayValue(Ya,(null===(ha=null==Ma?void 0:Ma.battery)||void 0===ha?void 0:ha.state_of_charge_unit)||"%",null===(va=null==Ma?void 0:Ma.battery)||void 0===va?void 0:va.state_of_charge_unit_white_space,(null===(_a=null==Ma?void 0:Ma.battery)||void 0===_a?void 0:_a.state_of_charge_decimals)||0)}</span>`:null}<ha-icon .icon="${qa}" style="${"two_way"===(null===(pa=Ma.battery)||void 0===pa?void 0:pa.display_state)?"padding-top: 0px; padding-bottom: 2px;":"one_way"===(null===(ma=Ma.battery)||void 0===ma?void 0:ma.display_state)&&0===Ta.state.toBattery&&0===Ta.state.fromBattery?"padding-top: 2px; padding-bottom: 0px;":"padding-top: 2px; padding-bottom: 2px;"}" @click="${e=>{var t;e.stopPropagation(),this.openDetails(e,null===(t=Ma.battery)||void 0===t?void 0:t.state_of_charge)}}" @keyDown="${e=>{var t;"Enter"===e.key&&(e.stopPropagation(),this.openDetails(e,null===(t=Ma.battery)||void 0===t?void 0:t.state_of_charge))}}"></ha-icon>${"two_way"===(null===(ya=Ma.battery)||void 0===ya?void 0:ya.display_state)||void 0===(null===(ga=Ma.battery)||void 0===ga?void 0:ga.display_state)||"one_way"===(null===(fa=Ma.battery)||void 0===fa?void 0:fa.display_state)&&Ta.state.toBattery>0||"one_way_no_zero"===(null===(ba=Ma.battery)||void 0===ba?void 0:ba.display_state)&&0!==Ta.state.toBattery?B`<span class="battery-in" @click="${e=>{const t="string"==typeof Ma.battery.entity?Ma.battery.entity:Ma.battery.entity.production;e.stopPropagation(),this.openDetails(e,t)}}" @keyDown="${e=>{if("Enter"===e.key){const t="string"==typeof Ma.battery.entity?Ma.battery.entity:Ma.battery.entity.production;e.stopPropagation(),this.openDetails(e,t)}}}"><ha-icon class="small" .icon="${"mdi:arrow-down"}"></ha-icon>${this.displayValue(Ta.state.toBattery)}</span>`:""} ${"two_way"===(null===(wa=Ma.battery)||void 0===wa?void 0:wa.display_state)||void 0===(null===(xa=Ma.battery)||void 0===xa?void 0:xa.display_state)||"one_way"===(null===(ka=Ma.battery)||void 0===ka?void 0:ka.display_state)&&Ta.state.fromBattery>0||"one_way_no_zero"===(null===($a=Ma.battery)||void 0===$a?void 0:$a.display_state)&&(0===Ta.state.toBattery||0!==Ta.state.fromBattery)?B`<span class="battery-out" @click="${e=>{const t="string"==typeof Ma.battery.entity?Ma.battery.entity:Ma.battery.entity.consumption;e.stopPropagation(),this.openDetails(e,t)}}" @keyDown="${e=>{if("Enter"===e.key){const t="string"==typeof Ma.battery.entity?Ma.battery.entity:Ma.battery.entity.consumption;e.stopPropagation(),this.openDetails(e,t)}}}"><ha-icon class="small" .icon="${"mdi:arrow-up"}"></ha-icon>${this.displayValue(Ta.state.fromBattery)}</span>`:""}</div><span class="label">${Ta.name}</span></div>`:B`<div class="spacer"></div>`} ${Ga.has&&Ba.has?B`<div class="circle-container individual1 bottom">${this.showLine(Ba.state||0)?B`<svg width="80" height="30"><path d="M40 40 v-40" id="individual1"/>${Ba.state?G`<circle r="2.4" class="individual1" vector-effect="non-scaling-stroke"><animateMotion dur="${this.additionalCircleRate(null===(Ea=Ma.individual1)||void 0===Ea?void 0:Ea.calculate_flow_rate,Ja.individual1)}s" repeatCount="indefinite" calcMode="linear" keyPoints="${(null===(Sa=Ma.individual1)||void 0===Sa?void 0:Sa.inverted_animation)?"0;1":"1;0"}" keyTimes="0;1"><mpath xlink:href="#individual1"></animateMotion></circle>`:""}</svg>`:B`<svg width="80" height="30"></svg>`}<div class="circle" @click="${e=>{this.openDetails(e,Ba.mainEntity)}}" @keyDown="${e=>{"Enter"===e.key&&this.openDetails(e,Ba.mainEntity)}}">${br(Ba,"individual1")}<ha-icon id="individual1-icon" .icon="${Ba.icon}" style="${Ba.secondary.has?"padding-top: 2px;":"padding-top: 0px;"}${!1!==(null===(Ca=Ma.individual1)||void 0===Ca?void 0:Ca.display_zero_state)||(Ba.state||0)>0?"padding-bottom: 2px;":"padding-bottom: 0px;"}"></ha-icon>${!1!==(null===(Aa=Ma.individual1)||void 0===Aa?void 0:Aa.display_zero_state)||(Ba.state||0)>0?B`<span class="individual1">${ur}</span>`:""}</div><span class="label">${Ba.name}</span></div>`:B`<div class="spacer"></div>`}</div>`:B`<div class="spacer"></div>`} ${Oa.has&&this.showLine(Oa.state.toHome||0)?B`<div class="lines ${gt({high:Ta.has,"individual1-individual2":!Ta.has&&Ga.has&&Ba.has})}"><svg viewBox="0 0 100 100" xmlns="http://www.w3.org/2000/svg" preserveAspectRatio="xMidYMid slice" id="solar-home-flow"><path id="solar" class="solar" d="M${Ta.has?55:53},0 v${ja.has?15:17} c0,${Ta.has?"30 10,30 30,30":"35 10,35 30,35"} h25" vector-effect="non-scaling-stroke"></path>${Oa.state.toHome?G`<circle r="1" class="solar" vector-effect="non-scaling-stroke"><animateMotion dur="${Ja.solarToHome}s" repeatCount="indefinite" calcMode="linear"><mpath xlink:href="#solar"></animateMotion></circle>`:""}</svg></div>`:""} ${ja.hasReturnToGrid&&Oa.has&&this.showLine(null!==(za=Oa.state.toGrid)&&void 0!==za?za:0)?B`<div class="lines ${gt({high:Ta.has,"individual1-individual2":!Ta.has&&Ga.has&&Ba.has})}"><svg viewBox="0 0 100 100" xmlns="http://www.w3.org/2000/svg" preserveAspectRatio="xMidYMid slice" id="solar-grid-flow"><path id="return" class="return" d="M${Ta.has?45:47},0 v15 c0,${Ta.has?"30 -10,30 -30,30":"35 -10,35 -30,35"} h-20" vector-effect="non-scaling-stroke"></path>${Oa.state.toGrid&&Oa.has?G`<circle r="1" class="return" vector-effect="non-scaling-stroke"><animateMotion dur="${Ja.solarToGrid}s" repeatCount="indefinite" calcMode="linear"><mpath xlink:href="#return"></animateMotion></circle>`:""}</svg></div>`:""} ${Ta.has&&Oa.has&&this.showLine(Oa.state.toBattery||0)?B`<div class="lines ${gt({high:Ta.has,"individual1-individual2":!Ta.has&&Ga.has&&Ba.has})}"><svg viewBox="0 0 100 100" xmlns="http://www.w3.org/2000/svg" preserveAspectRatio="xMidYMid slice" id="solar-battery-flow" class="flat-line"><path id="battery-solar" class="battery-solar" d="M50,0 V100" vector-effect="non-scaling-stroke"></path>${Oa.state.toBattery?G`<circle r="1" class="battery-solar" vector-effect="non-scaling-stroke"><animateMotion dur="${Ja.solarToBattery}s" repeatCount="indefinite" calcMode="linear"><mpath xlink:href="#battery-solar"></animateMotion></circle>`:""}</svg></div>`:""} ${ja.has&&this.showLine(ja.state.fromGrid)?B`<div class="lines ${gt({high:Ta.has,"individual1-individual2":!Ta.has&&Ga.has&&Ba.has})}"><svg viewBox="0 0 100 100" xmlns="http://www.w3.org/2000/svg" preserveAspectRatio="xMidYMid slice" id="grid-home-flow" class="flat-line"><path class="grid" id="grid" d="M0,${Ta.has?50:Oa.has?56:53} H100" vector-effect="non-scaling-stroke"></path>${ja.state.fromGrid?G`<circle r="1" class="grid" vector-effect="non-scaling-stroke"><animateMotion dur="${Ja.gridToHome}s" repeatCount="indefinite" calcMode="linear"><mpath xlink:href="#grid"></animateMotion></circle>`:""}</svg></div>`:null} ${Ta.has&&this.showLine(Ta.state.toHome)?B`<div class="lines ${gt({high:Ta.has,"individual1-individual2":!Ta.has&&Ga.has&&Ba.has})}"><svg viewBox="0 0 100 100" xmlns="http://www.w3.org/2000/svg" preserveAspectRatio="xMidYMid slice" id="battery-home-flow"><path id="battery-home" class="battery-home" d="M55,100 v-${ja.has?15:17} c0,-30 10,-30 30,-30 h20" vector-effect="non-scaling-stroke"></path>${Ta.state.toHome?G`<circle r="1" class="battery-home" vector-effect="non-scaling-stroke"><animateMotion dur="${Ja.batteryToHome}s" repeatCount="indefinite" calcMode="linear"><mpath xlink:href="#battery-home"></animateMotion></circle>`:""}</svg></div>`:""} ${ja.has&&Ta.has&&this.showLine(Math.max(ja.state.toBattery||0,Ta.state.toGrid||0))?B`<div class="lines ${gt({high:Ta.has,"individual1-individual2":!Ta.has&&Ga.has&&Ba.has})}"><svg viewBox="0 0 100 100" xmlns="http://www.w3.org/2000/svg" preserveAspectRatio="xMidYMid slice" id="battery-grid-flow"><path id="battery-grid" class="${gt({"battery-from-grid":Boolean(ja.state.toBattery),"battery-to-grid":Boolean(Ta.state.toGrid)})}" d="M45,100 v-15 c0,-30 -10,-30 -30,-30 h-20" vector-effect="non-scaling-stroke"></path>${ja.state.toBattery?G`<circle r="1" class="battery-from-grid" vector-effect="non-scaling-stroke"><animateMotion dur="${Ja.batteryGrid}s" repeatCount="indefinite" keyPoints="1;0" keyTimes="0;1" calcMode="linear"><mpath xlink:href="#battery-grid"></animateMotion></circle>`:""} ${Ta.state.toGrid?G`<circle r="1" class="battery-to-grid" vector-effect="non-scaling-stroke"><animateMotion dur="${Ja.batteryGrid}s" repeatCount="indefinite" calcMode="linear"><mpath xlink:href="#battery-grid"></animateMotion></circle>`:""}</svg></div>`:""}</div>${this._config.dashboard_link?B`<div class="card-actions"><a href="${this._config.dashboard_link}"><mwc-button>${this._config.dashboard_link_label||this.hass.localize("ui.panel.lovelace.cards.energy.energy_distribution.go_to_energy_dashboard")}</mwc-button></a></div>`:""}</ha-card>`}updated(e){var t;if(super.updated(e),!this._config||!this.hass)return;const o=null===(t=null==this?void 0:this.shadowRoot)||void 0===t?void 0:t.querySelector("#energy-flow-card-plus"),i=o?getComputedStyle(o).getPropertyValue("width"):"0px";this._width=parseInt(i.replace("px",""),10)}};Pt.styles=wt,e([se({attribute:!1})],Pt.prototype,"hass",void 0),e([de()],Pt.prototype,"_config",void 0),e([de()],Pt.prototype,"states",void 0),e([de()],Pt.prototype,"entitiesArr",void 0),e([de()],Pt.prototype,"error",void 0),e([de()],Pt.prototype,"_data",void 0),e([de()],Pt.prototype,"_width",void 0),Pt=e([ne("energy-flow-card-plus")],Pt);var jt=Pt;class Ot extends TypeError{constructor(e,t){let o;const{message:i,...a}=e,{path:r}=e;super(0===r.length?i:"At path: "+r.join(".")+" -- "+i),this.value=void 0,this.key=void 0,this.type=void 0,this.refinement=void 0,this.path=void 0,this.branch=void 0,this.failures=void 0,Object.assign(this,a),this.name=this.constructor.name,this.failures=()=>{var i;return null!=(i=o)?i:o=[e,...t()]}}}function Tt(e){return"object"==typeof e&&null!=e}function Nt(e){return"string"==typeof e?JSON.stringify(e):""+e}function Ut(e,t,o,i){if(!0===e)return;!1===e?e={}:"string"==typeof e&&(e={message:e});const{path:a,branch:r}=t,{type:n}=o,{refinement:l,message:s="Expected a value of type `"+n+"`"+(l?" with refinement `"+l+"`":"")+", but received: `"+Nt(i)+"`"}=e;return{value:i,type:n,refinement:l,key:a[a.length-1],path:a,branch:r,...e,message:s}}function*Bt(e,t,o,i){(function(e){return Tt(e)&&"function"==typeof e[Symbol.iterator]})(e)||(e=[e]);for(const a of e){const e=Ut(a,t,o,i);e&&(yield e)}}function*Gt(e,t,o){void 0===o&&(o={});const{path:i=[],branch:a=[e],coerce:r=!1,mask:n=!1}=o,l={path:i,branch:a};if(r&&(e=t.coercer(e,l),n&&"type"!==t.type&&Tt(t.schema)&&Tt(e)&&!Array.isArray(e)))for(const o in e)void 0===t.schema[o]&&delete e[o];let s=!0;for(const o of t.validator(e,l))s=!1,yield[o,void 0];for(let[o,d,c]of t.entries(e,l)){const t=Gt(d,c,{path:void 0===o?i:[...i,o],branch:void 0===o?a:[...a,d],coerce:r,mask:n});for(const i of t)i[0]?(s=!1,yield[i[0],void 0]):r&&(d=i[1],void 0===o?e=d:e instanceof Map?e.set(o,d):e instanceof Set?e.add(d):Tt(e)&&(e[o]=d))}if(s)for(const o of t.refiner(e,l))s=!1,yield[o,void 0];s&&(yield[void 0,e])}class It{constructor(e){this.TYPE=void 0,this.type=void 0,this.schema=void 0,this.coercer=void 0,this.validator=void 0,this.refiner=void 0,this.entries=void 0;const{type:t,schema:o,validator:i,refiner:a,coercer:r=(e=>e),entries:n=function*(){}}=e;this.type=t,this.schema=o,this.entries=n,this.coercer=r,this.validator=i?(e,t)=>Bt(i(e,t),t,this,e):()=>[],this.refiner=a?(e,t)=>Bt(a(e,t),t,this,e):()=>[]}assert(e){return Ht(e,this)}create(e){return function(e,t){const o=Ft(e,t,{coerce:!0});if(o[0])throw o[0];return o[1]}(e,this)}is(e){return function(e,t){const o=Ft(e,t);return!o[0]}(e,this)}mask(e){return function(e,t){const o=Ft(e,t,{coerce:!0,mask:!0});if(o[0])throw o[0];return o[1]}(e,this)}validate(e,t){return void 0===t&&(t={}),Ft(e,this,t)}}function Ht(e,t){const o=Ft(e,t);if(o[0])throw o[0]}function Ft(e,t,o){void 0===o&&(o={});const i=Gt(e,t,o),a=function(e){const{done:t,value:o}=e.next();return t?void 0:o}(i);if(a[0]){const e=new Ot(a[0],(function*(){for(const e of i)e[0]&&(yield e[0])}));return[e,void 0]}return[void 0,a[1]]}function Rt(e,t){return new It({type:e,schema:null,validator:t})}function Lt(){return Rt("any",(()=>!0))}function Wt(){return Rt("boolean",(e=>"boolean"==typeof e))}function Vt(){return Rt("integer",(e=>"number"==typeof e&&!isNaN(e)&&Number.isInteger(e)||"Expected an integer, but received: "+Nt(e)))}function Kt(){return Rt("number",(e=>"number"==typeof e&&!isNaN(e)||"Expected a number, but received: "+Nt(e)))}function Zt(e){const t=e?Object.keys(e):[],o=Rt("never",(()=>!1));return new It({type:"object",schema:e||null,*entries(i){if(e&&Tt(i)){const a=new Set(Object.keys(i));for(const o of t)a.delete(o),yield[o,i[o],e[o]];for(const e of a)yield[e,i[e],o]}},validator:e=>Tt(e)||"Expected an object, but received: "+Nt(e),coercer:e=>Tt(e)?{...e}:e})}function Yt(e){return new It({...e,validator:(t,o)=>void 0===t||e.validator(t,o),refiner:(t,o)=>void 0===t||e.refiner(t,o)})}function qt(){return Rt("string",(e=>"string"==typeof e||"Expected a string, but received: "+Nt(e)))}function Jt(){return{type:"expandable",title:Ke("editor.separated"),name:"entity",schema:[{name:"consumption",label:"Consumption Entity",selector:{entity:{}}},{name:"production",label:"Production Entity",selector:{entity:{}}}]}}const Qt={name:"color",title:Ke("editor.custom_colors"),type:"expandable",schema:[{type:"grid",column_min_width:"200px",schema:[{name:"consumption",label:"Consumption",selector:{color_rgb:{}}},{name:"production",label:"Production",selector:{color_rgb:{}}}]}]},Xt=[{name:"entity",selector:{entity:{}}},{name:"template",label:"Template (overrides entity, save to update)",selector:{template:{}}},{type:"grid",column_min_width:"200px",schema:[{name:"icon",selector:{icon:{}}},{name:"unit_of_measurement",label:"Unit of Measurement",selector:{text:{}}},{name:"color_value",label:"Color Value",selector:{boolean:{}}},{name:"unit_white_space",label:"Unit White Space",selector:{boolean:{}}},{name:"display_zero_tolerance",label:"Display Zero Tolerance",selector:{number:{mode:"box",min:0,max:1e6,step:.1}}},{name:"decimals",label:"Decimals",selector:{number:{mode:"box",min:0,max:10,step:1}}},{name:"display_zero",label:"Display Zero",selector:{boolean:{}}},{name:"energy_date_selection",label:"Energy Date Selection",selector:{boolean:{}}}]}],eo=[{name:"color_icon",label:"Color of Icon",selector:{select:{options:[{value:!1,label:"Do not Color"},{value:!0,label:"Color dynamically"},{value:"production",label:"Production"},{value:"consumption",label:"Consumption"}],custom_value:!0}}},{name:"color_circle",label:"Color of Circle",selector:{select:{options:[{value:!0,label:"Color dynamically"},{value:!1,label:"Consumption"},{value:"production",label:"Production"}],custom_value:!0}}},{name:"display_zero_tolerance",label:"Display Zero Tolerance",selector:{number:{min:0,max:1e6,step:1,mode:"box"}}},{name:"display_state",label:"Display State",selector:{select:{options:[{value:"two_way",label:"Two Way"},{value:"one_way",label:"One Way"},{value:"one_way_no_zero",label:"One Way (Show Zero)"}],custom_value:!0}}}];function to(e){const t={type:"grid",column_min_width:"200px",schema:[{name:"name",selector:{text:{}}},{name:"icon",selector:{icon:{}}},{name:"use_metadata",label:"Use Metadata",selector:{boolean:{}}}]};return"battery"!==e&&"grid"!==e||t.schema.push(...eo),t}const oo=Object.assign(Object.assign({},to("grid")),{schema:[...to("grid").schema,{name:"invert_state",label:"Invert State",selector:{boolean:{}}},{name:"use_metadata",label:"Use Metadata",selector:{boolean:{}}}]}),io=[Jt(),oo,Qt,{title:Ke("editor.secondary_info"),name:"secondary_info",type:"expandable",schema:Xt},{title:Ke("editor.power_outage"),name:"power_outage",type:"expandable",schema:[{name:"entity",selector:{entity:{}}},{type:"grid",column_min_width:"200px",schema:[{name:"label_alert",label:"Outage Label",selector:{text:{}}},{name:"icon_alert",label:"Outage Icon",selector:{icon:{}}},{name:"state_alert",label:"Outage State",selector:{text:{}}}]}]}],ao=Object.assign(Object.assign({},to("battery")),{schema:[...to("battery").schema,{name:"invert_state",label:"Invert State",selector:{boolean:{}}},{name:"use_metadata",label:"Use Metadata",selector:{boolean:{}}}]}),ro=[Jt(),{title:Ke("editor.state_of_charge"),name:"",type:"expandable",schema:[{name:"state_of_charge",label:"State of Charge Entity",selector:{entity:{}}},{name:"",type:"grid",column_min_width:"200px",schema:[{name:"state_of_charge_unit",label:"Unit",selector:{text:{}}},{name:"state_of_charge_unit_white_space",label:"Unit White Space",selector:{boolean:{}}},{name:"state_of_charge_decimals",label:"Decimals",selector:{number:{mode:"box",min:0,max:4,step:1}}},{name:"color_state_of_charge_value",label:"Color of Value",selector:{select:{options:[{value:!1,label:"Do Not Color"},{value:!0,label:"Color dynamically"},{value:"consumption",label:"Consumption"},{value:"production",label:"Production"}],custom_value:!0}}}]}]},ao,Qt],no=[{name:"entity",selector:{entity:{}}},Object.assign(Object.assign({},to()),{schema:[...to().schema,{name:"color_value",label:"Color Value",selector:{boolean:{}}},{name:"color_icon",label:"Color Icon",selector:{boolean:{}}},{name:"display_zero_state",label:"Display State When Zero?",selector:{boolean:{}}},{name:"display_zero_tolerance",label:"Display Zero Tolerance",selector:{number:{mode:"box",min:0,max:1e6,step:.1}}},{name:"use_metadata",label:"Use Metadata",selector:{boolean:{}}}]}),{name:"color",label:"Color",selector:{color_rgb:{}}},{title:Ke("editor.secondary_info"),name:"secondary_info",type:"expandable",schema:Xt}],lo=[{name:"entity",selector:{entity:{}}},Object.assign(Object.assign({},to()),{schema:[...to().schema,{name:"color_value",label:"Color Value",selector:{boolean:{}}},{name:"color_icon",label:"Color Icon",selector:{boolean:{}}},{name:"display_zero",label:"Display Zero",selector:{boolean:{}}},{name:"display_zero_tolerance",label:"Display Zero Tolerance",selector:{number:{mode:"box",min:0,max:1e6,step:.1}}},{name:"display_zero_state",label:"Display Zero State",selector:{boolean:{}}},{name:"unit_of_measurement",label:"Unit of Measurement",selector:{text:{}}},{name:"calculate_flow_rate",label:"Calculate Flow Rate",selector:{boolean:{}}},{name:"decimals",label:"Decimals",selector:{number:{mode:"box",min:0,max:4,step:1}}},{name:"inverted_animation",label:"Invert Animation",selector:{boolean:{}}},{name:"use_metadata",label:"Use Metadata",selector:{boolean:{}}}]}),{name:"color",label:"Color",selector:{color_rgb:{}}},{title:Ke("editor.secondary_info"),name:"secondary_info",type:"expandable",schema:Xt}],so=[{name:"show",label:"Show",selector:{boolean:{}}},{name:"entity",label:"Entity (Only used for click action)",selector:{entity:{}}},Object.assign(Object.assign({},to()),{schema:[...to().schema,{name:"state_type",label:"State Type",selector:{select:{options:[{value:"power",label:"Power"},{value:"percentage",label:"Percentage"}],custom_value:!0}}},{name:"color_value",label:"Color Value",selector:{boolean:{}}},{name:"color_icon",label:"Color Icon",selector:{boolean:{}}},{name:"display_zero",label:"Display Zero",selector:{boolean:{}}},{name:"display_zero_tolerance",label:"Display Zero Tolerance",selector:{number:{mode:"box",min:0,max:1e6,step:.1}}},{name:"display_zero_state",label:"Display Zero State",selector:{boolean:{}}},{name:"unit_white_space",label:"Unit White Space",selector:{boolean:{}}},{name:"decimals",label:"Decimals",selector:{number:{mode:"box",min:0,max:4,step:1}}}]}),{name:"color",label:"Color",selector:{color_rgb:{}}},{title:Ke("editor.secondary_info"),name:"secondary_info",type:"expandable",schema:Xt}],co=[{name:"entity",selector:{entity:{}}},Object.assign(Object.assign({},to()),{schema:[...to().schema,{name:"color_value",label:"Color Value",selector:{select:{options:[{value:!0,label:"Color dynamically"},{value:!1,label:"Do Not Color"},{value:"solar",label:"Solar"},{value:"grid",label:"Grid"},{value:"battery",label:"Battery"}],custom_value:!0}}},{name:"color_icon",label:"Color Icon",selector:{select:{options:[{value:!0,label:"Color dynamically"},{value:!1,label:"Do Not Color"},{value:"solar",label:"Solar"},{value:"grid",label:"Grid"},{value:"battery",label:"Battery"}],custom_value:!0}}},{name:"subtract_individual",label:"Subtract Individual",selector:{boolean:{}}},{name:"override_state",label:"Override State (With Home Entity)",selector:{boolean:{}}},{name:"use_metadata",label:"Use Metadata",selector:{boolean:{}}}]}),{title:Ke("editor.secondary_info"),name:"secondary_info",type:"expandable",schema:Xt}];var uo=Number.isNaN||function(e){return"number"==typeof e&&e!=e};function ho(e,t){if(e.length!==t.length)return!1;for(var o=0;o<e.length;o++)if(i=e[o],a=t[o],!(i===a||uo(i)&&uo(a)))return!1;var i,a;return!0}function vo(e,t){void 0===t&&(t=ho);var o=null;function i(){for(var i=[],a=0;a<arguments.length;a++)i[a]=arguments[a];if(o&&o.lastThis===this&&t(i,o.lastArgs))return o.lastResult;var r=e.apply(this,i);return o={lastResult:r,lastArgs:i,lastThis:this},r}return i.clear=function(){o=null},i}const _o=function(){for(var e=arguments.length,t=new Array(e),o=0;o<e;o++)t[o]=arguments[o];const i="type"===t[0].type,a=t.map((e=>e.schema)),r=Object.assign({},...a);return i?function(e){const t=Object.keys(e);return new It({type:"type",schema:e,*entries(o){if(Tt(o))for(const i of t)yield[i,o[i],e[i]]},validator:e=>Tt(e)||"Expected an object, but received: "+Nt(e)})}(r):Zt(r)}(Zt({type:qt(),view_layout:Lt()}),Zt({title:Yt(qt()),theme:Yt(qt()),dashboard_link:Yt(qt()),dashboard_link_label:Yt(qt()),wh_decimals:Yt(Vt()),kwh_decimals:Yt(Vt()),mwh_decimals:Yt(Vt()),min_flow_rate:Yt(Kt()),max_flow_rate:Yt(Kt()),min_expected_energy:Yt(Kt()),max_expected_energy:Yt(Kt()),wh_kwh_threshold:Yt(Kt()),kwh_mwh_threshold:Yt(Kt()),clickable_entities:Yt(Wt()),display_zero_lines:Yt(Wt()),use_new_flow_rate_model:Yt(Wt()),energy_date_selection:Yt(Wt()),entities:Zt({battery:Yt(Lt()),grid:Yt(Lt()),solar:Yt(Lt()),home:Yt(Lt()),fossil_fuel_percentage:Yt(Lt()),individual1:Yt(Lt()),individual2:Yt(Lt())})})),po=[{name:"title",label:"Title",selector:{text:{}}}],mo=vo((e=>[{name:"entities",type:"grid",column_min_width:"400px",schema:[{title:e("editor.grid"),name:"grid",type:"expandable",schema:io},{title:e("editor.solar"),name:"solar",type:"expandable",schema:no},{title:e("editor.battery"),name:"battery",type:"expandable",schema:ro},{title:e("editor.fossil_fuel_percentage"),name:"fossil_fuel_percentage",type:"expandable",schema:so},{title:e("editor.home"),name:"home",type:"expandable",schema:co},{title:`${e("editor.individual")} 1`,name:"individual1",type:"expandable",schema:lo},{title:`${e("editor.individual")} 2`,name:"individual2",type:"expandable",schema:lo}]}])),yo=vo((e=>[{title:e("editor.advanced"),type:"expandable",schema:[{type:"grid",column_min_width:"200px",schema:[{name:"dashboard_link",label:"Dashboard Link",selector:{navigation:{}}},{name:"dashboard_link_label",label:"Dashboard Link Label",selector:{text:{}}},{name:"wh_decimals",label:"Wh Decimals",selector:{number:{mode:"box",min:0,max:5,step:1}}},{name:"kwh_decimals",label:"kWh Decimals",selector:{number:{mode:"box",min:0,max:5,step:1}}},{name:"mwh_decimals",label:"MWh Decimals",selector:{number:{mode:"box",min:0,max:5,step:1}}},{name:"max_flow_rate",label:"Max Flow Rate (Sec/Dot)",selector:{number:{mode:"box",min:0,max:1e6,step:.01}}},{name:"min_flow_rate",label:"Min Flow Rate (Sec/Dot)",selector:{number:{mode:"box",min:0,max:1e6,step:.01}}},{name:"max_expected_energy",label:"Max Expected Power (in Watts)",selector:{number:{mode:"box",min:0,max:1e6,step:.01}}},{name:"min_expected_energy",label:"Min Expected Power (in Watts)",selector:{number:{mode:"box",min:0,max:1e6,step:.01}}},{name:"wh_kwh_threshold",label:"Wh/kWh Threshold",selector:{number:{mode:"box",min:0,max:1e6,step:1}}},{name:"kwh_mwh_threshold",label:"kWh/MWh Threshold",selector:{number:{mode:"box",min:0,max:1e6,step:1}}},{name:"display_zero_lines",label:"Display Zero Lines",selector:{boolean:{}}},{name:"clickable_entities",label:"Clickable Entities",selector:{boolean:{}}},{name:"energy_date_selection",label:"Energy Date Selection",selector:{boolean:{}}},{name:"use_new_flow_rate_model",label:"New Flow Model?",selector:{boolean:{}}}]}]}])),go=async()=>{var e,t;if(customElements.get("ha-form"))return;const o=await(null===(t=(e=window).loadCardHelpers)||void 0===t?void 0:t.call(e));if(!o)return;const i=await o.createCardElement({type:"entity"});i&&await i.getConfigElement()};let fo=class extends ae{constructor(){super(...arguments),this._computeLabelCallback=e=>this.hass.localize(`ui.panel.lovelace.editor.card.generic.${null==e?void 0:e.name}`)||Ke(`editor.${null==e?void 0:e.name}`)}async setConfig(e){Ht(e,_o),this._config=e}connectedCallback(){super.connectedCallback(),go()}render(){var e;if(!this.hass||!this._config)return H;const t=Object.assign(Object.assign({},this._config),{energy_date_selection:null===(e=this._config.energy_date_selection)||void 0===e||e});return B`<div class="card-config"><ha-form .hass="${this.hass}" .data="${t}" .schema="${po}" .computeLabel="${this._computeLabelCallback}" @value-changed="${this._valueChanged}"></ha-form><div style="height:24px"></div><ha-form .hass="${this.hass}" .data="${t}" .schema="${mo(Ke)}" .computeLabel="${this._computeLabelCallback}" @value-changed="${this._valueChanged}" class="entities-section"></ha-form><div style="height:24px"></div><ha-form .hass="${this.hass}" .data="${t}" .schema="${yo(Ke)}" .computeLabel="${this._computeLabelCallback}" @value-changed="${this._valueChanged}"></ha-form></div>`}_valueChanged(e){const t=e.detail.value||"";this._config&&this.hass&&function(e,t,o,i){i=i||{},o=null==o?{}:o;var a=new Event(t,{bubbles:void 0===i.bubbles||i.bubbles,cancelable:Boolean(i.cancelable),composed:void 0===i.composed||i.composed});a.detail=o,e.dispatchEvent(a)}(this,"config-changed",{config:t})}static get styles(){return n`ha-form{width:100%}ha-icon-button{align-self:center}.entities-section *{background-color:red}.card-config{display:flex;flex-direction:column;justify-content:space-between;align-items:center;margin-bottom:10px}.config-header{display:flex;flex-direction:row;justify-content:space-between;align-items:center;width:100%}.config-header.sub-header{margin-top:24px}ha-icon{padding-bottom:2px;position:relative;top:-4px;right:1px}`}};e([se({attribute:!1})],fo.prototype,"hass",void 0),e([de()],fo.prototype,"_config",void 0),fo=e([ne("energy-flow-card-plus-editor")],fo);var bo=Object.freeze({__proto__:null,loadHaForm:go,get EnergyFlowCardPlusEditor(){return fo}});export{jt as default};
