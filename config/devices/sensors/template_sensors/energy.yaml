- platform: template
  sensors:
    grid_consumption:
      friendly_name: Net afname
      unit_of_measurement: "W"
      value_template: >-
        {%- if states("sensor.huidige_opbrengst") | float < states("sensor.huidig_verbruik") | float %}
            {{ states("sensor.huidig_verbruik") | float - states("sensor.huidige_opbrengst") | float }}
        {%- elif states("sensor.huidige_opbrengst") | float > states("sensor.huidig_verbruik") | float %}
            {{ 0 | float }}
        {% endif %}

    grid_production:
      friendly_name: Net terugsturen
      unit_of_measurement: "W"
      value_template: >-
        {%- if states("sensor.huidige_opbrengst") | float < states("sensor.huidig_verbruik") | float %}
            {{ 0 | float }}
        {%- elif states("sensor.huidige_opbrengst") | float > states("sensor.huidig_verbruik") | float %}
            {{ states("sensor.huidige_opbrengst") | float - states("sensor.huidig_verbruik") | float }}
          {% endif %}

    grid_energy_consumption:
      friendly_name: Net afname
      unit_of_measurement: "kWh"
      value_template: >-
        {%- if states("sensor.daily_solar") | float < states("sensor.daily_energy") | float %}
            {{ (states("sensor.daily_energy") | float - states("sensor.daily_solar") | float)  | round(3)  }}
        {%- elif states("sensor.daily_solar") | float > states("sensor.daily_energy") | float %}
            {{ 0 | float }}
        {% endif %}

    grid_energy_production:
      friendly_name: Net terugsturen
      unit_of_measurement: "kWh"
      value_template: >-
        {%- if states("sensor.daily_solar") | float < states("sensor.daily_energy") | float %}
            {{ 0 | float }}
        {%- elif states("sensor.daily_solar") | float > states("sensor.daily_energy") | float %}
            {{ (states("sensor.daily_solar") | float - states("sensor.daily_energy") | float)  | round(3) }}
        {% endif %}

    eigen_verbruik:
      friendly_name: Eigen verbruik
      unit_of_measurement: "W"
      value_template: >-
        {% if (states("sensor.huidige_opbrengst") | float - states("sensor.huidig_verbruik") | float) > 0 %}
            {{ states("sensor.huidig_verbruik") | float  }}
        {% elif (states("sensor.huidige_opbrengst") | float - states("sensor.huidig_verbruik") | float) < 0 and states("sensor.huidige_opbrengst") | float > 0 %}
            {{ states("sensor.huidige_opbrengst") | float  }}
        {% else  %}
            {{ 0 | float }}
        {% endif %}

    verlichting_verbruik:
      friendly_name: Verlichting energie
      unit_of_measurement: "kWh"
      value_template: >-
        {{ (states("sensor.danszaal_luster_energie") | float + 
            states("sensor.zithoek_luster_energie") | float + 
            states("sensor.gang_boven_energie") | float + 
            states("sensor.slaapkamer_hoog_energie") | float + 
            states("sensor.keuken_inkom_energie") | float + 
            states("sensor.keuken_spots_energie") | float + 
            states("sensor.danszaal_spots_energie") | float + 
            states("sensor.wc_energie") | float + 
            states("sensor.garage_energie") | float + 
            states("sensor.garage_werkbank_energie") | float + 
            states("sensor.badkamer_hoog_energie") | float + 
            states("sensor.badkamer_pombak_energie") | float + 
            states("sensor.gang_beneden_energie") | float + 
            states("sensor.keuken_luster_energie") | float + 
            states("sensor.trap_energie") | float + 
            states("sensor.waskot_energie") | float) | round (3)}}
