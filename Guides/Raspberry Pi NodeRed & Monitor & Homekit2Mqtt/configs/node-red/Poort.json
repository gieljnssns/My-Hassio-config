[{"id":"73f2aa21.994e64","type":"tab","label":"Poort","disabled":false,"info":""},{"id":"13acf7da.abce9","type":"mqtt-broker","z":"","name":"Home-Assistant broker","broker":"192.168.79.54","port":"1883","clientid":"","usetls":false,"compatmode":true,"keepalive":"60","cleansession":true,"birthTopic":"PoortjePi/status","birthQos":"0","birthRetain":"true","birthPayload":"online","closeTopic":"PoortjePi/status","closeQos":"0","closeRetain":"true","closePayload":"offline","willTopic":"PoortjePi/status","willQos":"0","willRetain":"false","willPayload":"offline"},{"id":"ba06d54d.5460a8","type":"rpi-gpio in","z":"73f2aa21.994e64","name":"Pin 15 Fotocel","pin":"15","intype":"tri","debounce":"25","read":false,"x":270,"y":60,"wires":[["f5da7c78.66f5"]]},{"id":"f5da7c78.66f5","type":"mqtt out","z":"73f2aa21.994e64","name":"MQTT Fotocel","topic":"PoortjePi/input/fotocel","qos":"","retain":"","broker":"13acf7da.abce9","x":720,"y":60,"wires":[]},{"id":"349facf7.51a474","type":"rpi-dht22","z":"73f2aa21.994e64","name":"DHT22","topic":"rpi-dht22","dht":22,"pintype":"2","pin":"7","x":300,"y":220,"wires":[["8cdd58fb.0ebd88","7c6404ef.1fc3bc"]]},{"id":"d20a0826.cd65f8","type":"inject","z":"73f2aa21.994e64","name":"Elke minuut","topic":"","payload":"","payloadType":"date","repeat":"60","crontab":"","once":false,"onceDelay":0.1,"x":70,"y":720,"wires":[["349facf7.51a474","ca3581ec.66a4a","1ac590dc.a7669f","ff0f0650.104288","a7cf4c40.42771","f1c2a251.0e78"]]},{"id":"7667a722.6e7968","type":"mqtt out","z":"73f2aa21.994e64","name":"MQTT DHT temperatuur","topic":"PoortjePi/input/temperatuur","qos":"","retain":"","broker":"13acf7da.abce9","x":778,"y":218,"wires":[]},{"id":"8cdd58fb.0ebd88","type":"function","z":"73f2aa21.994e64","name":"temperatuur","func":"msg.payload = msg.payload\nreturn msg;","outputs":1,"noerr":0,"x":501,"y":217,"wires":[["7667a722.6e7968"]]},{"id":"7c6404ef.1fc3bc","type":"function","z":"73f2aa21.994e64","name":"luchtvochtigheid","func":"msg.payload = msg.humidity\nreturn msg;","outputs":1,"noerr":0,"x":503,"y":344,"wires":[["626f3caa.bd8524"]]},{"id":"626f3caa.bd8524","type":"mqtt out","z":"73f2aa21.994e64","name":"MQTT DHT luchtvochtigheid","topic":"PoortjePi/input/luchtvochtigheid","qos":"","retain":"","broker":"13acf7da.abce9","x":785,"y":343,"wires":[]},{"id":"b567f998.762e08","type":"inject","z":"73f2aa21.994e64","name":"","topic":"","payload":"","payloadType":"date","repeat":"10","crontab":"","once":false,"onceDelay":"","x":190,"y":1440,"wires":[["d8a4a925.c04318"]]},{"id":"ff0f0650.104288","type":"vcgencmd","z":"73f2aa21.994e64","name":"","command":"get_throttled","codec":"H264","clock":"core","voltage":"core","memory":"arm","videoOutput":"0","separateMsg":false,"x":340,"y":720,"wires":[["50347213.f3047c","aace1cf4.1d024"]]},{"id":"d8a4a925.c04318","type":"cpu","z":"73f2aa21.994e64","name":"","msgCore":false,"msgOverall":true,"msgArray":false,"msgTemp":false,"x":448.5,"y":1445.75,"wires":[["c58d3005.33f83"]]},{"id":"ca3581ec.66a4a","type":"vcgencmd","z":"73f2aa21.994e64","name":"","command":"measure_temp","codec":"H264","clock":"core","voltage":"core","memory":"arm","videoOutput":"0","separateMsg":false,"x":360.5,"y":478.75,"wires":[["e83bd8da.976238"]]},{"id":"3647477a.ecaac8","type":"Uptime","z":"73f2aa21.994e64","name":"","x":360,"y":1560,"wires":[["c33f1888.c99e38"]]},{"id":"1ac590dc.a7669f","type":"Memory","z":"73f2aa21.994e64","name":"","x":329,"y":577,"wires":[["f2761d59.f8a96"]]},{"id":"9dbca562.df0c58","type":"inject","z":"73f2aa21.994e64","name":"update","topic":"","payload":"","payloadType":"date","repeat":"3600","crontab":"","once":true,"onceDelay":"","x":178,"y":1560,"wires":[["3647477a.ecaac8"]]},{"id":"c33f1888.c99e38","type":"function","z":"73f2aa21.994e64","name":"","func":"function timeConversion(millisec) {\n\n    var seconds = (millisec / 1000).toFixed(1);\n\n    var minutes = (millisec / (1000 * 60)).toFixed(1);\n\n    var hours = (millisec / (1000 * 60 * 60)).toFixed(1);\n\n    var days = (millisec / (1000 * 60 * 60 * 24)).toFixed(1);\n\n    if (seconds < 60) {\n        return seconds + \" Sec\";\n    } else if (minutes < 60) {\n        return minutes + \" Min\";\n    } else if (hours < 24) {\n        return hours + \" Hrs\";\n    } else {\n        return days + \" Days\"\n    }\n}\n\nmsg.payload = timeConversion(msg.payload.uptime * 1000);\nreturn msg;","outputs":1,"noerr":0,"x":520,"y":1560,"wires":[["bfbe25ab.514f48"]]},{"id":"f2761d59.f8a96","type":"function","z":"73f2aa21.994e64","name":"","func":"msg.payload = msg.payload.memusage;\nreturn msg;","outputs":1,"noerr":0,"x":502,"y":577,"wires":[["7ae598af.2be798"]]},{"id":"50347213.f3047c","type":"function","z":"73f2aa21.994e64","name":"Undervoltage","func":"msg.payload = msg.payload.underVoltage;\nreturn msg;","outputs":1,"noerr":0,"x":544,"y":723,"wires":[["b06f601e.5ebed"]]},{"id":"aace1cf4.1d024","type":"function","z":"73f2aa21.994e64","name":"Throttle","func":"msg.payload = msg.payload.throttled;\nreturn msg;","outputs":1,"noerr":0,"x":532,"y":850,"wires":[["da59f621.cc7df8"]]},{"id":"e83bd8da.976238","type":"mqtt out","z":"73f2aa21.994e64","name":"","topic":"PoortjePi/system/temp","qos":"","retain":"","broker":"13acf7da.abce9","x":774.5,"y":476.75,"wires":[]},{"id":"c58d3005.33f83","type":"mqtt out","z":"73f2aa21.994e64","name":"","topic":"PoortjePi/system/cpu","qos":"","retain":"","broker":"13acf7da.abce9","x":866.5,"y":1450.75,"wires":[]},{"id":"7ae598af.2be798","type":"mqtt out","z":"73f2aa21.994e64","name":"","topic":"PoortjePi/system/mem","qos":"","retain":"","broker":"13acf7da.abce9","x":763,"y":577,"wires":[]},{"id":"b06f601e.5ebed","type":"mqtt out","z":"73f2aa21.994e64","name":"","topic":"PoortjePi/system/undervoltage","qos":"","retain":"","broker":"13acf7da.abce9","x":807,"y":720,"wires":[]},{"id":"da59f621.cc7df8","type":"mqtt out","z":"73f2aa21.994e64","name":"","topic":"PoortjePi/system/throttle","qos":"","retain":"","broker":"13acf7da.abce9","x":764,"y":855,"wires":[]},{"id":"bfbe25ab.514f48","type":"mqtt out","z":"73f2aa21.994e64","name":"","topic":"PoortjePi/system/uptime","qos":"","retain":"true","broker":"13acf7da.abce9","x":792,"y":1563,"wires":[]},{"id":"a7cf4c40.42771","type":"exec","z":"73f2aa21.994e64","command":"cat /proc/net/wireless | grep wlan0: | awk '{print int($4)}'","addpay":false,"append":"","useSpawn":"false","timer":"","oldrc":false,"name":"Wifi signal","x":294.5,"y":984.25,"wires":[["73c1671c.033308"],[],[]]},{"id":"73c1671c.033308","type":"mqtt out","z":"73f2aa21.994e64","name":"","topic":"PoortjePi/system/wifi","qos":"","retain":"","broker":"13acf7da.abce9","x":694.5,"y":984.25,"wires":[]},{"id":"5591fb03.e9e274","type":"exec","z":"73f2aa21.994e64","command":"sudo reboot","addpay":false,"append":"","useSpawn":"","timer":"","name":"Reboot","x":500,"y":1680,"wires":[[],[],[]]},{"id":"a816b91c.e455b8","type":"exec","z":"73f2aa21.994e64","command":"sudo shutdown -h now","addpay":false,"append":"","useSpawn":"","timer":"","name":"Shutdown","x":510,"y":1760,"wires":[[],[],[]]},{"id":"d0889a5a.4ec4b8","type":"mqtt in","z":"73f2aa21.994e64","name":"","topic":"PoortjePi/system/reboot","qos":"2","datatype":"auto","broker":"13acf7da.abce9","x":220,"y":1680,"wires":[["5591fb03.e9e274"]]},{"id":"bedb538c.cbbe1","type":"mqtt in","z":"73f2aa21.994e64","name":"","topic":"PoortjePi/system/shutdown","qos":"2","datatype":"auto","broker":"13acf7da.abce9","x":230,"y":1760,"wires":[["a816b91c.e455b8"]]},{"id":"984f5ea5.bb525","type":"rpi-gpio out","z":"73f2aa21.994e64","name":"Stopcontact","pin":"18","set":"","level":"0","freq":"","out":"out","x":710,"y":1900,"wires":[]},{"id":"fc2fa1f8.ad7ee","type":"mqtt in","z":"73f2aa21.994e64","name":"","topic":"PoortjePi/output/stopcontact/set","qos":"2","datatype":"auto","broker":"13acf7da.abce9","x":170,"y":1920,"wires":[["ee42ea94.2af1e8","eaa6c8b0.d90e08"]]},{"id":"eaa6c8b0.d90e08","type":"function","z":"73f2aa21.994e64","name":"Off -> 0 and On -> 1","func":"var newMsg = {}\nif (msg.payload === \"OFF\"){\n  newMsg.payload = 0\n} else if (msg.payload === \"ON\"){\n  newMsg.payload = 1\n}\nreturn newMsg","outputs":1,"noerr":0,"x":425,"y":1896,"wires":[["984f5ea5.bb525"]]},{"id":"ee42ea94.2af1e8","type":"function","z":"73f2aa21.994e64","name":"Status msg","func":"var newMsg = {}\nif (msg.payload === \"OFF\"){\n  newMsg.payload = \"OFF\"\n} else if (msg.payload === \"ON\"){\n  newMsg.payload = \"ON\"\n}\nreturn newMsg","outputs":1,"noerr":0,"x":402,"y":1958,"wires":[["30c02669.174bda"]]},{"id":"30c02669.174bda","type":"mqtt out","z":"73f2aa21.994e64","name":"Stopcontact status","topic":"PoortjePi/output/stopcontact/status","qos":"","retain":"","broker":"13acf7da.abce9","x":731,"y":1952,"wires":[]},{"id":"5b6909ec.0e49e8","type":"inject","z":"73f2aa21.994e64","name":"","topic":"","payload":"online","payloadType":"str","repeat":"60","crontab":"","once":false,"onceDelay":0.1,"x":110,"y":120,"wires":[["a493f725.c1e788"]]},{"id":"a493f725.c1e788","type":"mqtt out","z":"73f2aa21.994e64","name":"","topic":"PoortjePi/status","qos":"","retain":"","broker":"13acf7da.abce9","x":330,"y":140,"wires":[]},{"id":"f1c2a251.0e78","type":"exec","z":"73f2aa21.994e64","command":"free -m | grep Swap | awk '{printf \"%.2f\\n\", $3/$2 * 100}'","addpay":false,"append":"","useSpawn":"false","timer":"","oldrc":false,"name":"Swap %","x":284.5,"y":1124.25,"wires":[["2a8b1975.7cc7f6"],[],[]]},{"id":"2a8b1975.7cc7f6","type":"mqtt out","z":"73f2aa21.994e64","name":"","topic":"PoortjePi/system/swap","qos":"","retain":"","broker":"13acf7da.abce9","x":704.5,"y":1124.25,"wires":[]}]